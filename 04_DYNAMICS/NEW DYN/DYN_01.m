%% Authors:
% Made by Tran Minh Phuc
% Date: 2022/05/01:
% NOTE: test cach moi chung minh skew matrix (OK)

clc;
clear all;
close all;
syms e1 e2 e3 e4 e5 e6 
syms de1 de2 de3 de4 de5 de6 
syms dde1 dde2 dde3 dde4 dde5 dde6 
syms a1 a2 a3 d1 d4 d7 
syms m1 m2 m3 m4 m5 m6 
syms I1 I2 I3 I4 I5 I6 
syms g 
syms x1 x2 x3 x4 x5 x6 x7 
syms y1 y2 y3 y4 y5 y6 y7 
syms z1 z2 z3 z4 z5 z6 z7 
syms I1xx I1xy I1yy I1yz I1zx I1zz 
syms I2xx I2xy I2yy I2yz I2zx I2zz 
syms I3xx I3xy I3yy I3yz I3zx I3zz 
syms I4xx I4xy I4yy I4yz I4zx I4zz 
syms I5xx I5xy I5yy I5yz I5zx I5zz 
syms I6xx I6xy I6yy I6yz I6zx I6zz 
%% Moment of Inertia
I1 = [I1xx -I1xy -I1zx; -I1xy I1yy -I1yz; -I1zx -I1yz I1zz];
I2 = [I2xx -I2xy -I2zx; -I2xy I2yy -I2yz; -I2zx -I2yz I2zz];
I3 = [I3xx -I3xy -I3zx; -I3xy I3yy -I3yz; -I3zx -I3yz I3zz];
I4 = [I4xx -I4xy -I4zx; -I4xy I4yy -I4yz; -I4zx -I4yz I4zz];
I5 = [I5xx -I5xy -I5zx; -I5xy I5yy -I5yz; -I5zx -I5yz I5zz];
I6 = [I6xx -I6xy -I6zx; -I6xy I6yy -I6yz; -I6zx -I6yz I6zz];
%% Forward kinematics:
[T01,R01,R10,P01] = FKRobot2021(0,0,d1,e1);
[T12,R12,R21,P12] = FKRobot2021(a1,sym(-pi/2),0,e2-sym(pi/2));
[T23,R23,R32,P23] = FKRobot2021(a2,0,0,e3);
[T34,R34,R43,P34] = FKRobot2021(a3,sym(-pi/2),d4,e4);
[T45,R45,R54,P45] = FKRobot2021(0,sym(pi/2),0,e5);
[T56,R56,R65,P56] = FKRobot2021(0,sym(-pi/2),0,e6);
[T67,R67,R76,P67] = FKRobot2021(0,0,d7,0);
T02 = simplify(T01*T12);
T03 = simplify(T02*T23);
T04 = simplify(T03*T34);
T05 = simplify(T04*T45);
T06 = simplify(T05*T56);
T07 = simplify(T06*T67);
R02 = T02(1:3,1:3);
R03 = T03(1:3,1:3);
R04 = T04(1:3,1:3);
R05 = T05(1:3,1:3);
R06 = T06(1:3,1:3);
R07 = T07(1:3,1:3);
P02 = T02(1:3,4)
P03 = T03(1:3,4)
P04 = T04(1:3,4)
P05 = T05(1:3,4)
P06 = T06(1:3,4)
P07 = T07(1:3,4)
P = [P01 P02 P03 P04 P05 P06 P07]
% plot3(P(1,:), P(2,:), P(3,:),'-O','linewidth',2)
%% Angular Velocity
dR01 = (diff(R01,e1)*de1);
S1 = simplify(R01.'*dR01);
w1 = [S1(3,2); S1(1,3); S1(2,1)];
dR02 = (diff(R02,e1)*de1 + diff(R02,e2)*de2);
S2 = simplify(R02.'*dR02);
w2 = [S2(3,2); S2(1,3); S2(2,1)];
dR03 = (diff(R03,e1)*de1 + diff(R03,e2)*de2 + diff(R03,e3)*de3);
S3 = simplify(R03.'*dR03);
w3 = [S3(3,2); S3(1,3); S3(2,1)];
dR04 = (diff(R04,e1)*de1 + diff(R04,e2)*de2 + diff(R04,e3)*de3 + diff(R04,e4)*de4);
S4 = simplify(R04.'*dR04);
w4 = simplify(expand([S4(3,2); S4(1,3); S4(2,1)]));
dR05 = diff(R05,e1)*de1 + diff(R05,e2)*de2 + diff(R05,e3)*de3 + diff(R05,e4)*de4 + diff(R05,e5)*de5;
S5 = simplify(R05.'*dR05);
w5 = simplify(expand([S5(3,2); S5(1,3); S5(2,1)]));
dR06 = diff(R06,e1)*de1 + diff(R06,e2)*de2 + diff(R06,e3)*de3 + diff(R06,e4)*de4 + diff(R06,e5)*de5 + diff(R06,e6)*de6;
S6 = simplify(R06.'*dR06);
w6 = simplify(expand([S6(3,2); S6(1,3); S6(2,1)]));
%% Rotational Jacobian Matrices
JR1 = [diff(w1,de1) diff(w1,de2) diff(w1,de3) diff(w1,de4) diff(w1,de5) diff(w1,de6)];
JR2 = [diff(w2,de1) diff(w2,de2) diff(w2,de3) diff(w2,de4) diff(w2,de5) diff(w2,de6)];
JR3 = [diff(w3,de1) diff(w3,de2) diff(w3,de3) diff(w3,de4) diff(w3,de5) diff(w3,de6)];
JR4 = [diff(w4,de1) diff(w4,de2) diff(w4,de3) diff(w4,de4) diff(w4,de5) diff(w4,de6)];
JR5 = [diff(w5,de1) diff(w5,de2) diff(w5,de3) diff(w5,de4) diff(w5,de5) diff(w5,de6)];
JR6 = [diff(w6,de1) diff(w6,de2) diff(w6,de3) diff(w6,de4) diff(w6,de5) diff(w6,de6)];
%% Position vectors of the link centroids
P1c = [x1 y1 z1].';
P2c = [x2 y2 z2].';
P3c = [x3 y3 z3].';
P4c = [x4 y4 z4].';
P5c = [x5 y5 z5].';
P6c = [x6 y6 z6].';

TP01c = simplify(T01*[P1c; 1]);
P01c = TP01c(1:3,1);
TP02c = simplify(T02*[P2c; 1]);
P02c = TP02c(1:3,1);
TP03c = simplify(T03*[P3c; 1]);
P03c = TP03c(1:3,1);
TP04c = simplify(T04*[P4c; 1]);
P04c = TP04c(1:3,1);
TP05c = simplify(T05*[P5c; 1]);
P05c = TP05c(1:3,1);
TP06c = simplify(T06*[P6c; 1]);
P06c = TP06c(1:3,1);
%% Translational Jacobian Matrices
JT1 = [diff(P01c,e1) diff(P01c,e2) diff(P01c,e3) diff(P01c,e4) diff(P01c,e5) diff(P01c,e6)];
JT2 = [diff(P02c,e1) diff(P02c,e2) diff(P02c,e3) diff(P02c,e4) diff(P02c,e5) diff(P02c,e6)];
JT3 = [diff(P03c,e1) diff(P03c,e2) diff(P03c,e3) diff(P03c,e4) diff(P03c,e5) diff(P03c,e6)];
JT4 = [diff(P04c,e1) diff(P04c,e2) diff(P04c,e3) diff(P04c,e4) diff(P04c,e5) diff(P04c,e6)];
JT5 = [diff(P05c,e1) diff(P05c,e2) diff(P05c,e3) diff(P05c,e4) diff(P05c,e5) diff(P05c,e6)];
JT6 = [diff(P06c,e1) diff(P06c,e2) diff(P06c,e3) diff(P06c,e4) diff(P06c,e5) diff(P06c,e6)];
%% Inertia matrix
M = (m1*(JT1).'*JT1 + (JR1).'*I1*JR1 + m2*(JT2).'*JT2 + (JR2).'*I2*JR2 + m3*(JT3).'*JT3 + (JR3).'*I3*JR3 + m4*(JT4).'*JT4 + (JR4).'*I4*JR4 + m5*(JT5).'*JT5 + (JR5).'*I5*JR5 + m6*(JT6).'*JT6 + (JR6).'*I6*JR6)
M11 = simplify(M(1,1))
M12 = simplify(M(1,2))
M13 = simplify(M(1,3))
M14 = simplify(M(1,4))
M15 = simplify(M(1,5))
M16 = simplify(M(1,6))
M21 = simplify(M(2,1))
M22 = simplify(M(2,2))
M23 = simplify(M(2,3))
M24 = simplify(M(2,4))
M25 = simplify(M(2,5))
M26 = simplify(M(2,6))
M31 = simplify(M(3,1))
M32 = simplify(M(3,2))
M33 = simplify(M(3,3))
M34 = simplify(M(3,4))
M35 = simplify(M(3,5))
M36 = simplify(M(3,6))
M41 = simplify(M(4,1))
M42 = simplify(M(4,2))
M43 = simplify(M(4,3))
M44 = simplify(M(4,4))
M45 = simplify(M(4,5))
M46 = simplify(M(4,6))
M51 = simplify(M(5,1))
M52 = simplify(M(5,2))
M53 = simplify(M(5,3))
M54 = simplify(M(5,4))
M55 = simplify(M(5,5))
M56 = simplify(M(5,6))
M61 = simplify(M(6,1))
M62 = simplify(M(6,2))
M63 = simplify(M(6,3))
M64 = simplify(M(6,4))
M65 = simplify(M(6,5))
M66 = simplify(M(6,6))

% M11 = I1zz + m3*(cos(e1)*(a1 + a2*sin(e2)) - z3*sin(e1) + y3*cos(e2 + e3)*cos(e1) + x3*sin(e2 + e3)*cos(e1))^2 + m6*(sin(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) - x6*(sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) + cos(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) - y6*(cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - sin(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) + z6*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)))^2 + (I6xx*(cos(e2)*cos(e3)*sin(e4)*sin(e6) + cos(e2)*cos(e6)*sin(e3)*sin(e5) + cos(e3)*cos(e6)*sin(e2)*sin(e5) - sin(e2)*sin(e3)*sin(e4)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*cos(e6) + cos(e4)*cos(e5)*cos(e6)*sin(e2)*sin(e3)) + I6xy*(cos(e6)*sin(e2)*sin(e3)*sin(e4) - cos(e2)*cos(e3)*cos(e6)*sin(e4) + cos(e2)*sin(e3)*sin(e5)*sin(e6) + cos(e3)*sin(e2)*sin(e5)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*sin(e6) + cos(e4)*cos(e5)*sin(e2)*sin(e3)*sin(e6)) - I6zx*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5)))*(cos(e2)*cos(e3)*sin(e4)*sin(e6) + cos(e2)*cos(e6)*sin(e3)*sin(e5) + cos(e3)*cos(e6)*sin(e2)*sin(e5) - sin(e2)*sin(e3)*sin(e4)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*cos(e6) + cos(e4)*cos(e5)*cos(e6)*sin(e2)*sin(e3)) + (cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4))*(I5zz*(cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4)) + I5yz*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5)) + I5zx*(cos(e2)*sin(e3)*sin(e5) + cos(e3)*sin(e2)*sin(e5) - cos(e2)*cos(e3)*cos(e4)*cos(e5) + cos(e4)*cos(e5)*sin(e2)*sin(e3))) + (cos(e2)*cos(e3)*cos(e4) - cos(e4)*sin(e2)*sin(e3))*(I4zx*sin(e2 + e3) + I4xx*(cos(e2)*cos(e3)*cos(e4) - cos(e4)*sin(e2)*sin(e3)) + I4xy*(cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4))) + m3*(sin(e1)*(a1 + a2*sin(e2)) + z3*cos(e1) + y3*cos(e2 + e3)*sin(e1) + x3*sin(e2 + e3)*sin(e1))^2 + (I6xy*(cos(e2)*cos(e3)*sin(e4)*sin(e6) + cos(e2)*cos(e6)*sin(e3)*sin(e5) + cos(e3)*cos(e6)*sin(e2)*sin(e5) - sin(e2)*sin(e3)*sin(e4)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*cos(e6) + cos(e4)*cos(e5)*cos(e6)*sin(e2)*sin(e3)) + I6yy*(cos(e6)*sin(e2)*sin(e3)*sin(e4) - cos(e2)*cos(e3)*cos(e6)*sin(e4) + cos(e2)*sin(e3)*sin(e5)*sin(e6) + cos(e3)*sin(e2)*sin(e5)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*sin(e6) + cos(e4)*cos(e5)*sin(e2)*sin(e3)*sin(e6)) + I6yz*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5)))*(cos(e6)*sin(e2)*sin(e3)*sin(e4) - cos(e2)*cos(e3)*cos(e6)*sin(e4) + cos(e2)*sin(e3)*sin(e5)*sin(e6) + cos(e3)*sin(e2)*sin(e5)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*sin(e6) + cos(e4)*cos(e5)*sin(e2)*sin(e3)*sin(e6)) + (I5zx*(cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4)) + I5xx*(cos(e2)*sin(e3)*sin(e5) + cos(e3)*sin(e2)*sin(e5) - cos(e2)*cos(e3)*cos(e4)*cos(e5) + cos(e4)*cos(e5)*sin(e2)*sin(e3)) - I5xy*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5)))*(cos(e2)*sin(e3)*sin(e5) + cos(e3)*sin(e2)*sin(e5) - cos(e2)*cos(e3)*cos(e4)*cos(e5) + cos(e4)*cos(e5)*sin(e2)*sin(e3)) + (I5yz*(cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4)) - I5xy*(cos(e2)*sin(e3)*sin(e5) + cos(e3)*sin(e2)*sin(e5) - cos(e2)*cos(e3)*cos(e4)*cos(e5) + cos(e4)*cos(e5)*sin(e2)*sin(e3)) + I5yy*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5)))*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5)) + m5*(cos(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) - z5*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + x5*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5)) - y5*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5)))^2 + (cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4))*(I4xy*(cos(e2)*cos(e3)*cos(e4) - cos(e4)*sin(e2)*sin(e3)) - I4yz*sin(e2 + e3) + I4yy*(cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4))) + cos(e2)*(I2xx*cos(e2) + I2xy*sin(e2)) + sin(e2)*(I2xy*cos(e2) + I2yy*sin(e2)) + m4*(cos(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) + x4*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + y4*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + z4*cos(e2 + e3)*cos(e1))^2 + m5*(sin(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) + z5*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - x5*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5)) + y5*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)))^2 + m2*(a1*cos(e1) - z2*sin(e1) + y2*cos(e1)*cos(e2) + x2*cos(e1)*sin(e2))^2 + (I6yz*(cos(e6)*sin(e2)*sin(e3)*sin(e4) - cos(e2)*cos(e3)*cos(e6)*sin(e4) + cos(e2)*sin(e3)*sin(e5)*sin(e6) + cos(e3)*sin(e2)*sin(e5)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*sin(e6) + cos(e4)*cos(e5)*sin(e2)*sin(e3)*sin(e6)) - I6zx*(cos(e2)*cos(e3)*sin(e4)*sin(e6) + cos(e2)*cos(e6)*sin(e3)*sin(e5) + cos(e3)*cos(e6)*sin(e2)*sin(e5) - sin(e2)*sin(e3)*sin(e4)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*cos(e6) + cos(e4)*cos(e5)*cos(e6)*sin(e2)*sin(e3)) + I6zz*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5)))*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5)) + m4*(sin(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) - x4*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - y4*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) + z4*cos(e2 + e3)*sin(e1))^2 + cos(e2 + e3)*(I3xx*cos(e2 + e3) + I3xy*sin(e2 + e3)) + m2*(a1*sin(e1) + z2*cos(e1) + y2*cos(e2)*sin(e1) + x2*sin(e1)*sin(e2))^2 + sin(e2 + e3)*(I3xy*cos(e2 + e3) + I3yy*sin(e2 + e3)) + m1*(y1*cos(e1) + x1*sin(e1))^2 + m1*(x1*cos(e1) - y1*sin(e1))^2 + m6*(cos(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) + x6*(sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + cos(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) + y6*(cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - sin(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) - z6*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5)))^2 + sin(e2 + e3)*(I4zz*sin(e2 + e3) + I4zx*(cos(e2)*cos(e3)*cos(e4) - cos(e4)*sin(e2)*sin(e3)) - I4yz*(cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4)));
% M12 = cos(e4)*(I4xy*(cos(e2)*cos(e3)*cos(e4) - cos(e4)*sin(e2)*sin(e3)) - I4yz*sin(e2 + e3) + I4yy*(cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4))) - sin(e4)*(I4zx*sin(e2 + e3) + I4xx*(cos(e2)*cos(e3)*cos(e4) - cos(e4)*sin(e2)*sin(e3)) + I4xy*(cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4))) - I3zx*cos(e2 + e3) + I3yz*sin(e2 + e3) - I2zx*cos(e2) + I2yz*sin(e2) + (cos(e4)*sin(e6) + cos(e5)*cos(e6)*sin(e4))*(I6xx*(cos(e2)*cos(e3)*sin(e4)*sin(e6) + cos(e2)*cos(e6)*sin(e3)*sin(e5) + cos(e3)*cos(e6)*sin(e2)*sin(e5) - sin(e2)*sin(e3)*sin(e4)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*cos(e6) + cos(e4)*cos(e5)*cos(e6)*sin(e2)*sin(e3)) + I6xy*(cos(e6)*sin(e2)*sin(e3)*sin(e4) - cos(e2)*cos(e3)*cos(e6)*sin(e4) + cos(e2)*sin(e3)*sin(e5)*sin(e6) + cos(e3)*sin(e2)*sin(e5)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*sin(e6) + cos(e4)*cos(e5)*sin(e2)*sin(e3)*sin(e6)) - I6zx*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5))) - (cos(e4)*cos(e6) - cos(e5)*sin(e4)*sin(e6))*(I6xy*(cos(e2)*cos(e3)*sin(e4)*sin(e6) + cos(e2)*cos(e6)*sin(e3)*sin(e5) + cos(e3)*cos(e6)*sin(e2)*sin(e5) - sin(e2)*sin(e3)*sin(e4)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*cos(e6) + cos(e4)*cos(e5)*cos(e6)*sin(e2)*sin(e3)) + I6yy*(cos(e6)*sin(e2)*sin(e3)*sin(e4) - cos(e2)*cos(e3)*cos(e6)*sin(e4) + cos(e2)*sin(e3)*sin(e5)*sin(e6) + cos(e3)*sin(e2)*sin(e5)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*sin(e6) + cos(e4)*cos(e5)*sin(e2)*sin(e3)*sin(e6)) + I6yz*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5))) + cos(e4)*(I5zz*(cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4)) + I5yz*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5)) + I5zx*(cos(e2)*sin(e3)*sin(e5) + cos(e3)*sin(e2)*sin(e5) - cos(e2)*cos(e3)*cos(e4)*cos(e5) + cos(e4)*cos(e5)*sin(e2)*sin(e3))) - m3*(x3*cos(e2 + e3)*cos(e1) - y3*sin(e2 + e3)*cos(e1) + a2*cos(e1)*cos(e2))*(sin(e1)*(a1 + a2*sin(e2)) + z3*cos(e1) + y3*cos(e2 + e3)*sin(e1) + x3*sin(e2 + e3)*sin(e1)) + m3*(x3*cos(e2 + e3)*sin(e1) - y3*sin(e2 + e3)*sin(e1) + a2*cos(e2)*sin(e1))*(cos(e1)*(a1 + a2*sin(e2)) - z3*sin(e1) + y3*cos(e2 + e3)*cos(e1) + x3*sin(e2 + e3)*cos(e1)) + m6*(sin(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) - x6*(sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) + cos(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) - y6*(cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - sin(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) + z6*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)))*(x6*(cos(e6)*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) + cos(e2 + e3)*cos(e1)*sin(e4)*sin(e6)) - y6*(sin(e6)*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) - cos(e2 + e3)*cos(e1)*cos(e6)*sin(e4)) + z6*(sin(e2 + e3)*cos(e1)*cos(e5) + cos(e2 + e3)*cos(e1)*cos(e4)*sin(e5)) - cos(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3) + a2*cos(e2))) - sin(e4)*sin(e5)*(I6yz*(cos(e6)*sin(e2)*sin(e3)*sin(e4) - cos(e2)*cos(e3)*cos(e6)*sin(e4) + cos(e2)*sin(e3)*sin(e5)*sin(e6) + cos(e3)*sin(e2)*sin(e5)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*sin(e6) + cos(e4)*cos(e5)*sin(e2)*sin(e3)*sin(e6)) - I6zx*(cos(e2)*cos(e3)*sin(e4)*sin(e6) + cos(e2)*cos(e6)*sin(e3)*sin(e5) + cos(e3)*cos(e6)*sin(e2)*sin(e5) - sin(e2)*sin(e3)*sin(e4)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*cos(e6) + cos(e4)*cos(e5)*cos(e6)*sin(e2)*sin(e3)) + I6zz*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5))) - m6*(cos(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) + x6*(sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + cos(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) + y6*(cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - sin(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) - z6*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5)))*(x6*(cos(e6)*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) + cos(e2 + e3)*sin(e1)*sin(e4)*sin(e6)) - y6*(sin(e6)*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) - cos(e2 + e3)*cos(e6)*sin(e1)*sin(e4)) + z6*(sin(e2 + e3)*cos(e5)*sin(e1) + cos(e2 + e3)*cos(e4)*sin(e1)*sin(e5)) - sin(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3) + a2*cos(e2))) + m5*(x5*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) + y5*(sin(e2 + e3)*cos(e1)*cos(e5) + cos(e2 + e3)*cos(e1)*cos(e4)*sin(e5)) - cos(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3) + a2*cos(e2)) - z5*cos(e2 + e3)*cos(e1)*sin(e4))*(sin(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) + z5*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - x5*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5)) + y5*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1))) - m2*(x2*cos(e1)*cos(e2) - y2*cos(e1)*sin(e2))*(a1*sin(e1) + z2*cos(e1) + y2*cos(e2)*sin(e1) + x2*sin(e1)*sin(e2)) + m2*(x2*cos(e2)*sin(e1) - y2*sin(e1)*sin(e2))*(a1*cos(e1) - z2*sin(e1) + y2*cos(e1)*cos(e2) + x2*cos(e1)*sin(e2)) - m4*(cos(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3) + a2*cos(e2)) - z4*sin(e2 + e3)*cos(e1) - y4*cos(e2 + e3)*cos(e1)*sin(e4) + x4*cos(e2 + e3)*cos(e1)*cos(e4))*(sin(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) - x4*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - y4*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) + z4*cos(e2 + e3)*sin(e1)) - m5*(cos(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) - z5*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + x5*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5)) - y5*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5)))*(x5*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) + y5*(sin(e2 + e3)*cos(e5)*sin(e1) + cos(e2 + e3)*cos(e4)*sin(e1)*sin(e5)) - sin(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3) + a2*cos(e2)) - z5*cos(e2 + e3)*sin(e1)*sin(e4)) + m4*(cos(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) + x4*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + y4*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + z4*cos(e2 + e3)*cos(e1))*(sin(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3) + a2*cos(e2)) - z4*sin(e2 + e3)*sin(e1) + x4*cos(e2 + e3)*cos(e4)*sin(e1) - y4*cos(e2 + e3)*sin(e1)*sin(e4)) + cos(e5)*sin(e4)*(I5zx*(cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4)) + I5xx*(cos(e2)*sin(e3)*sin(e5) + cos(e3)*sin(e2)*sin(e5) - cos(e2)*cos(e3)*cos(e4)*cos(e5) + cos(e4)*cos(e5)*sin(e2)*sin(e3)) - I5xy*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5))) - sin(e4)*sin(e5)*(I5yz*(cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4)) - I5xy*(cos(e2)*sin(e3)*sin(e5) + cos(e3)*sin(e2)*sin(e5) - cos(e2)*cos(e3)*cos(e4)*cos(e5) + cos(e4)*cos(e5)*sin(e2)*sin(e3)) + I5yy*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5)));
% M13 = cos(e4)*(I4xy*(cos(e2)*cos(e3)*cos(e4) - cos(e4)*sin(e2)*sin(e3)) - I4yz*sin(e2 + e3) + I4yy*(cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4))) - sin(e4)*(I4zx*sin(e2 + e3) + I4xx*(cos(e2)*cos(e3)*cos(e4) - cos(e4)*sin(e2)*sin(e3)) + I4xy*(cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4))) - I3zx*cos(e2 + e3) + I3yz*sin(e2 + e3) + (cos(e4)*sin(e6) + cos(e5)*cos(e6)*sin(e4))*(I6xx*(cos(e2)*cos(e3)*sin(e4)*sin(e6) + cos(e2)*cos(e6)*sin(e3)*sin(e5) + cos(e3)*cos(e6)*sin(e2)*sin(e5) - sin(e2)*sin(e3)*sin(e4)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*cos(e6) + cos(e4)*cos(e5)*cos(e6)*sin(e2)*sin(e3)) + I6xy*(cos(e6)*sin(e2)*sin(e3)*sin(e4) - cos(e2)*cos(e3)*cos(e6)*sin(e4) + cos(e2)*sin(e3)*sin(e5)*sin(e6) + cos(e3)*sin(e2)*sin(e5)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*sin(e6) + cos(e4)*cos(e5)*sin(e2)*sin(e3)*sin(e6)) - I6zx*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5))) - (cos(e4)*cos(e6) - cos(e5)*sin(e4)*sin(e6))*(I6xy*(cos(e2)*cos(e3)*sin(e4)*sin(e6) + cos(e2)*cos(e6)*sin(e3)*sin(e5) + cos(e3)*cos(e6)*sin(e2)*sin(e5) - sin(e2)*sin(e3)*sin(e4)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*cos(e6) + cos(e4)*cos(e5)*cos(e6)*sin(e2)*sin(e3)) + I6yy*(cos(e6)*sin(e2)*sin(e3)*sin(e4) - cos(e2)*cos(e3)*cos(e6)*sin(e4) + cos(e2)*sin(e3)*sin(e5)*sin(e6) + cos(e3)*sin(e2)*sin(e5)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*sin(e6) + cos(e4)*cos(e5)*sin(e2)*sin(e3)*sin(e6)) + I6yz*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5))) + cos(e4)*(I5zz*(cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4)) + I5yz*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5)) + I5zx*(cos(e2)*sin(e3)*sin(e5) + cos(e3)*sin(e2)*sin(e5) - cos(e2)*cos(e3)*cos(e4)*cos(e5) + cos(e4)*cos(e5)*sin(e2)*sin(e3))) + m5*(sin(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) + z5*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - x5*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5)) + y5*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)))*(x5*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) + y5*(sin(e2 + e3)*cos(e1)*cos(e5) + cos(e2 + e3)*cos(e1)*cos(e4)*sin(e5)) - cos(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3)) - z5*cos(e2 + e3)*cos(e1)*sin(e4)) - m4*(sin(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) - x4*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - y4*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) + z4*cos(e2 + e3)*sin(e1))*(cos(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3)) - z4*sin(e2 + e3)*cos(e1) - y4*cos(e2 + e3)*cos(e1)*sin(e4) + x4*cos(e2 + e3)*cos(e1)*cos(e4)) - sin(e4)*sin(e5)*(I6yz*(cos(e6)*sin(e2)*sin(e3)*sin(e4) - cos(e2)*cos(e3)*cos(e6)*sin(e4) + cos(e2)*sin(e3)*sin(e5)*sin(e6) + cos(e3)*sin(e2)*sin(e5)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*sin(e6) + cos(e4)*cos(e5)*sin(e2)*sin(e3)*sin(e6)) - I6zx*(cos(e2)*cos(e3)*sin(e4)*sin(e6) + cos(e2)*cos(e6)*sin(e3)*sin(e5) + cos(e3)*cos(e6)*sin(e2)*sin(e5) - sin(e2)*sin(e3)*sin(e4)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*cos(e6) + cos(e4)*cos(e5)*cos(e6)*sin(e2)*sin(e3)) + I6zz*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5))) - m5*(x5*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) + y5*(sin(e2 + e3)*cos(e5)*sin(e1) + cos(e2 + e3)*cos(e4)*sin(e1)*sin(e5)) - sin(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3)) - z5*cos(e2 + e3)*sin(e1)*sin(e4))*(cos(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) - z5*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + x5*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5)) - y5*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5))) + m4*(sin(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3)) - z4*sin(e2 + e3)*sin(e1) + x4*cos(e2 + e3)*cos(e4)*sin(e1) - y4*cos(e2 + e3)*sin(e1)*sin(e4))*(cos(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) + x4*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + y4*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + z4*cos(e2 + e3)*cos(e1)) + m6*(sin(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) - x6*(sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) + cos(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) - y6*(cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - sin(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) + z6*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)))*(x6*(cos(e6)*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) + cos(e2 + e3)*cos(e1)*sin(e4)*sin(e6)) - y6*(sin(e6)*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) - cos(e2 + e3)*cos(e1)*cos(e6)*sin(e4)) + z6*(sin(e2 + e3)*cos(e1)*cos(e5) + cos(e2 + e3)*cos(e1)*cos(e4)*sin(e5)) - cos(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3))) - m3*(x3*cos(e2 + e3)*cos(e1) - y3*sin(e2 + e3)*cos(e1))*(sin(e1)*(a1 + a2*sin(e2)) + z3*cos(e1) + y3*cos(e2 + e3)*sin(e1) + x3*sin(e2 + e3)*sin(e1)) + m3*(x3*cos(e2 + e3)*sin(e1) - y3*sin(e2 + e3)*sin(e1))*(cos(e1)*(a1 + a2*sin(e2)) - z3*sin(e1) + y3*cos(e2 + e3)*cos(e1) + x3*sin(e2 + e3)*cos(e1)) + cos(e5)*sin(e4)*(I5zx*(cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4)) + I5xx*(cos(e2)*sin(e3)*sin(e5) + cos(e3)*sin(e2)*sin(e5) - cos(e2)*cos(e3)*cos(e4)*cos(e5) + cos(e4)*cos(e5)*sin(e2)*sin(e3)) - I5xy*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5))) - m6*(x6*(cos(e6)*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) + cos(e2 + e3)*sin(e1)*sin(e4)*sin(e6)) - y6*(sin(e6)*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) - cos(e2 + e3)*cos(e6)*sin(e1)*sin(e4)) + z6*(sin(e2 + e3)*cos(e5)*sin(e1) + cos(e2 + e3)*cos(e4)*sin(e1)*sin(e5)) - sin(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3)))*(cos(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) + x6*(sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + cos(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) + y6*(cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - sin(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) - z6*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5))) - sin(e4)*sin(e5)*(I5yz*(cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4)) - I5xy*(cos(e2)*sin(e3)*sin(e5) + cos(e3)*sin(e2)*sin(e5) - cos(e2)*cos(e3)*cos(e4)*cos(e5) + cos(e4)*cos(e5)*sin(e2)*sin(e3)) + I5yy*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5)));
% M14 = I4yz*(cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4)) - cos(e5)*(I6yz*(cos(e6)*sin(e2)*sin(e3)*sin(e4) - cos(e2)*cos(e3)*cos(e6)*sin(e4) + cos(e2)*sin(e3)*sin(e5)*sin(e6) + cos(e3)*sin(e2)*sin(e5)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*sin(e6) + cos(e4)*cos(e5)*sin(e2)*sin(e3)*sin(e6)) - I6zx*(cos(e2)*cos(e3)*sin(e4)*sin(e6) + cos(e2)*cos(e6)*sin(e3)*sin(e5) + cos(e3)*cos(e6)*sin(e2)*sin(e5) - sin(e2)*sin(e3)*sin(e4)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*cos(e6) + cos(e4)*cos(e5)*cos(e6)*sin(e2)*sin(e3)) + I6zz*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5))) - I4zz*sin(e2 + e3) - I4zx*(cos(e2)*cos(e3)*cos(e4) - cos(e4)*sin(e2)*sin(e3)) - sin(e5)*(I5zx*(cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4)) + I5xx*(cos(e2)*sin(e3)*sin(e5) + cos(e3)*sin(e2)*sin(e5) - cos(e2)*cos(e3)*cos(e4)*cos(e5) + cos(e4)*cos(e5)*sin(e2)*sin(e3)) - I5xy*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5))) - cos(e5)*(I5yz*(cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4)) - I5xy*(cos(e2)*sin(e3)*sin(e5) + cos(e3)*sin(e2)*sin(e5) - cos(e2)*cos(e3)*cos(e4)*cos(e5) + cos(e4)*cos(e5)*sin(e2)*sin(e3)) + I5yy*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5))) - cos(e6)*sin(e5)*(I6xx*(cos(e2)*cos(e3)*sin(e4)*sin(e6) + cos(e2)*cos(e6)*sin(e3)*sin(e5) + cos(e3)*cos(e6)*sin(e2)*sin(e5) - sin(e2)*sin(e3)*sin(e4)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*cos(e6) + cos(e4)*cos(e5)*cos(e6)*sin(e2)*sin(e3)) + I6xy*(cos(e6)*sin(e2)*sin(e3)*sin(e4) - cos(e2)*cos(e3)*cos(e6)*sin(e4) + cos(e2)*sin(e3)*sin(e5)*sin(e6) + cos(e3)*sin(e2)*sin(e5)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*sin(e6) + cos(e4)*cos(e5)*sin(e2)*sin(e3)*sin(e6)) - I6zx*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5))) - sin(e5)*sin(e6)*(I6xy*(cos(e2)*cos(e3)*sin(e4)*sin(e6) + cos(e2)*cos(e6)*sin(e3)*sin(e5) + cos(e3)*cos(e6)*sin(e2)*sin(e5) - sin(e2)*sin(e3)*sin(e4)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*cos(e6) + cos(e4)*cos(e5)*cos(e6)*sin(e2)*sin(e3)) + I6yy*(cos(e6)*sin(e2)*sin(e3)*sin(e4) - cos(e2)*cos(e3)*cos(e6)*sin(e4) + cos(e2)*sin(e3)*sin(e5)*sin(e6) + cos(e3)*sin(e2)*sin(e5)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*sin(e6) + cos(e4)*cos(e5)*sin(e2)*sin(e3)*sin(e6)) + I6yz*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5))) - m4*(x4*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - y4*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)))*(cos(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) + x4*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + y4*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + z4*cos(e2 + e3)*cos(e1)) + m6*(x6*(sin(e6)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e5)*cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4))) + y6*(cos(e6)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e5)*sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4))) + z6*sin(e5)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)))*(cos(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) + x6*(sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + cos(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) + y6*(cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - sin(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) - z6*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5))) - m4*(x4*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - y4*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)))*(sin(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) - x4*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - y4*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) + z4*cos(e2 + e3)*sin(e1)) - m5*(z5*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + x5*cos(e5)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - y5*sin(e5)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)))*(cos(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) - z5*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + x5*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5)) - y5*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5))) + m6*(x6*(sin(e6)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e5)*cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4))) + y6*(cos(e6)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e5)*sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4))) + z6*sin(e5)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)))*(sin(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) - x6*(sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) + cos(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) - y6*(cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - sin(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) + z6*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1))) - m5*(z5*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + x5*cos(e5)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - y5*sin(e5)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)))*(sin(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) + z5*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - x5*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5)) + y5*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)));
% M15 = sin(e6)*(I6xx*(cos(e2)*cos(e3)*sin(e4)*sin(e6) + cos(e2)*cos(e6)*sin(e3)*sin(e5) + cos(e3)*cos(e6)*sin(e2)*sin(e5) - sin(e2)*sin(e3)*sin(e4)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*cos(e6) + cos(e4)*cos(e5)*cos(e6)*sin(e2)*sin(e3)) + I6xy*(cos(e6)*sin(e2)*sin(e3)*sin(e4) - cos(e2)*cos(e3)*cos(e6)*sin(e4) + cos(e2)*sin(e3)*sin(e5)*sin(e6) + cos(e3)*sin(e2)*sin(e5)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*sin(e6) + cos(e4)*cos(e5)*sin(e2)*sin(e3)*sin(e6)) - I6zx*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5))) - cos(e6)*(I6xy*(cos(e2)*cos(e3)*sin(e4)*sin(e6) + cos(e2)*cos(e6)*sin(e3)*sin(e5) + cos(e3)*cos(e6)*sin(e2)*sin(e5) - sin(e2)*sin(e3)*sin(e4)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*cos(e6) + cos(e4)*cos(e5)*cos(e6)*sin(e2)*sin(e3)) + I6yy*(cos(e6)*sin(e2)*sin(e3)*sin(e4) - cos(e2)*cos(e3)*cos(e6)*sin(e4) + cos(e2)*sin(e3)*sin(e5)*sin(e6) + cos(e3)*sin(e2)*sin(e5)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*sin(e6) + cos(e4)*cos(e5)*sin(e2)*sin(e3)*sin(e6)) + I6yz*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5))) + I5zz*(cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4)) + I5yz*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5)) + I5zx*(cos(e2)*sin(e3)*sin(e5) + cos(e3)*sin(e2)*sin(e5) - cos(e2)*cos(e3)*cos(e4)*cos(e5) + cos(e4)*cos(e5)*sin(e2)*sin(e3)) + m5*(x5*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)) + y5*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5)))*(cos(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) - z5*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + x5*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5)) - y5*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5))) + m5*(x5*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5)) + y5*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5)))*(sin(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) + z5*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - x5*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5)) + y5*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1))) + m6*(z6*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5)) + x6*cos(e6)*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)) - y6*sin(e6)*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)))*(cos(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) + x6*(sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + cos(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) + y6*(cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - sin(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) - z6*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5))) + m6*(z6*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5)) + x6*cos(e6)*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5)) - y6*sin(e6)*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5)))*(sin(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) - x6*(sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) + cos(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) - y6*(cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - sin(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) + z6*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)));
% M16 = I6zx*(cos(e2)*cos(e3)*sin(e4)*sin(e6) + cos(e2)*cos(e6)*sin(e3)*sin(e5) + cos(e3)*cos(e6)*sin(e2)*sin(e5) - sin(e2)*sin(e3)*sin(e4)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*cos(e6) + cos(e4)*cos(e5)*cos(e6)*sin(e2)*sin(e3)) - I6yz*(cos(e6)*sin(e2)*sin(e3)*sin(e4) - cos(e2)*cos(e3)*cos(e6)*sin(e4) + cos(e2)*sin(e3)*sin(e5)*sin(e6) + cos(e3)*sin(e2)*sin(e5)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*sin(e6) + cos(e4)*cos(e5)*sin(e2)*sin(e3)*sin(e6)) - I6zz*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5)) - m6*(x6*(cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - sin(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) - y6*(sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) + cos(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))))*(cos(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) + x6*(sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + cos(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) + y6*(cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - sin(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) - z6*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5))) - m6*(x6*(cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - sin(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) - y6*(sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + cos(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))))*(sin(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) - x6*(sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) + cos(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) - y6*(cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - sin(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) + z6*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)));
% 
% M21 = (I5zx*cos(e4) + I5xx*cos(e5)*sin(e4) + I5xy*sin(e4)*sin(e5))*(cos(e2)*sin(e3)*sin(e5) + cos(e3)*sin(e2)*sin(e5) - cos(e2)*cos(e3)*cos(e4)*cos(e5) + cos(e4)*cos(e5)*sin(e2)*sin(e3)) - (I5xy*cos(e5)*sin(e4) - I5yz*cos(e4) + I5yy*sin(e4)*sin(e5))*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5)) - I3zx*cos(e2 + e3) + I3yz*sin(e2 + e3) - sin(e2 + e3)*(I4yz*cos(e4) + I4zx*sin(e4)) - I2zx*cos(e2) + (I6xx*(cos(e4)*sin(e6) + cos(e5)*cos(e6)*sin(e4)) - I6xy*(cos(e4)*cos(e6) - cos(e5)*sin(e4)*sin(e6)) + I6zx*sin(e4)*sin(e5))*(cos(e2)*cos(e3)*sin(e4)*sin(e6) + cos(e2)*cos(e6)*sin(e3)*sin(e5) + cos(e3)*cos(e6)*sin(e2)*sin(e5) - sin(e2)*sin(e3)*sin(e4)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*cos(e6) + cos(e4)*cos(e5)*cos(e6)*sin(e2)*sin(e3)) + I2yz*sin(e2) - (I6yy*(cos(e4)*cos(e6) - cos(e5)*sin(e4)*sin(e6)) - I6xy*(cos(e4)*sin(e6) + cos(e5)*cos(e6)*sin(e4)) + I6yz*sin(e4)*sin(e5))*(cos(e6)*sin(e2)*sin(e3)*sin(e4) - cos(e2)*cos(e3)*cos(e6)*sin(e4) + cos(e2)*sin(e3)*sin(e5)*sin(e6) + cos(e3)*sin(e2)*sin(e5)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*sin(e6) + cos(e4)*cos(e5)*sin(e2)*sin(e3)*sin(e6)) + (I4xy*cos(e4) - I4xx*sin(e4))*(cos(e2)*cos(e3)*cos(e4) - cos(e4)*sin(e2)*sin(e3)) + (cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4))*(I4yy*cos(e4) - I4xy*sin(e4)) + (cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4))*(I5zz*cos(e4) + I5zx*cos(e5)*sin(e4) - I5yz*sin(e4)*sin(e5)) - (I6yz*(cos(e4)*cos(e6) - cos(e5)*sin(e4)*sin(e6)) + I6zx*(cos(e4)*sin(e6) + cos(e5)*cos(e6)*sin(e4)) + I6zz*sin(e4)*sin(e5))*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5)) - m3*(x3*cos(e2 + e3)*cos(e1) - y3*sin(e2 + e3)*cos(e1) + a2*cos(e1)*cos(e2))*(sin(e1)*(a1 + a2*sin(e2)) + z3*cos(e1) + y3*cos(e2 + e3)*sin(e1) + x3*sin(e2 + e3)*sin(e1)) + m3*(x3*cos(e2 + e3)*sin(e1) - y3*sin(e2 + e3)*sin(e1) + a2*cos(e2)*sin(e1))*(cos(e1)*(a1 + a2*sin(e2)) - z3*sin(e1) + y3*cos(e2 + e3)*cos(e1) + x3*sin(e2 + e3)*cos(e1)) + m6*(sin(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) - x6*(sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) + cos(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) - y6*(cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - sin(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) + z6*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)))*(x6*(cos(e6)*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) + cos(e2 + e3)*cos(e1)*sin(e4)*sin(e6)) - y6*(sin(e6)*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) - cos(e2 + e3)*cos(e1)*cos(e6)*sin(e4)) + z6*(sin(e2 + e3)*cos(e1)*cos(e5) + cos(e2 + e3)*cos(e1)*cos(e4)*sin(e5)) - cos(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3) + a2*cos(e2))) - m6*(cos(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) + x6*(sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + cos(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) + y6*(cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - sin(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) - z6*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5)))*(x6*(cos(e6)*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) + cos(e2 + e3)*sin(e1)*sin(e4)*sin(e6)) - y6*(sin(e6)*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) - cos(e2 + e3)*cos(e6)*sin(e1)*sin(e4)) + z6*(sin(e2 + e3)*cos(e5)*sin(e1) + cos(e2 + e3)*cos(e4)*sin(e1)*sin(e5)) - sin(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3) + a2*cos(e2))) + m5*(x5*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) + y5*(sin(e2 + e3)*cos(e1)*cos(e5) + cos(e2 + e3)*cos(e1)*cos(e4)*sin(e5)) - cos(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3) + a2*cos(e2)) - z5*cos(e2 + e3)*cos(e1)*sin(e4))*(sin(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) + z5*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - x5*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5)) + y5*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1))) - m2*(x2*cos(e1)*cos(e2) - y2*cos(e1)*sin(e2))*(a1*sin(e1) + z2*cos(e1) + y2*cos(e2)*sin(e1) + x2*sin(e1)*sin(e2)) + m2*(x2*cos(e2)*sin(e1) - y2*sin(e1)*sin(e2))*(a1*cos(e1) - z2*sin(e1) + y2*cos(e1)*cos(e2) + x2*cos(e1)*sin(e2)) - m4*(cos(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3) + a2*cos(e2)) - z4*sin(e2 + e3)*cos(e1) - y4*cos(e2 + e3)*cos(e1)*sin(e4) + x4*cos(e2 + e3)*cos(e1)*cos(e4))*(sin(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) - x4*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - y4*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) + z4*cos(e2 + e3)*sin(e1)) - m5*(cos(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) - z5*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + x5*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5)) - y5*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5)))*(x5*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) + y5*(sin(e2 + e3)*cos(e5)*sin(e1) + cos(e2 + e3)*cos(e4)*sin(e1)*sin(e5)) - sin(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3) + a2*cos(e2)) - z5*cos(e2 + e3)*sin(e1)*sin(e4)) + m4*(cos(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) + x4*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + y4*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + z4*cos(e2 + e3)*cos(e1))*(sin(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3) + a2*cos(e2)) - z4*sin(e2 + e3)*sin(e1) + x4*cos(e2 + e3)*cos(e4)*sin(e1) - y4*cos(e2 + e3)*sin(e1)*sin(e4));
% M22 = I4xx + I5yy + I2zz + I3zz + I6zz + a2^2*m3 + a2^2*m4 + a2^2*m5 + a3^2*m4 + a2^2*m6 + a3^2*m5 + a3^2*m6 + d4^2*m4 + d4^2*m5 + d4^2*m6 + m2*x2^2 + m3*x3^2 + m5*x5^2 + m6*x6^2 + m2*y2^2 + m3*y3^2 + m4*y4^2 + m6*y6^2 + m4*z4^2 + m5*z5^2 - I4xx*cos(e4)^2 + I5xx*cos(e5)^2 + I6xx*cos(e4)^2 + I4yy*cos(e4)^2 - I5yy*cos(e4)^2 - I5yy*cos(e5)^2 + I6yy*cos(e5)^2 + I5zz*cos(e4)^2 - I6zz*cos(e4)^2 - I6zz*cos(e5)^2 - I4xy*sin(2*e4) + I5xy*sin(2*e5) + 2*d4*m4*z4 + m4*x4^2*cos(e4)^2 - m5*x5^2*cos(e5)^2 - m6*x6^2*cos(e4)^2 - m4*y4^2*cos(e4)^2 + m5*y5^2*cos(e4)^2 + m5*y5^2*cos(e5)^2 - m6*y6^2*cos(e5)^2 - m5*z5^2*cos(e4)^2 + m6*z6^2*cos(e4)^2 + m6*z6^2*cos(e5)^2 - I5xx*cos(e4)^2*cos(e5)^2 - I6xx*cos(e4)^2*cos(e6)^2 + I6xx*cos(e5)^2*cos(e6)^2 + I5yy*cos(e4)^2*cos(e5)^2 - I6yy*cos(e4)^2*cos(e5)^2 + I6yy*cos(e4)^2*cos(e6)^2 - I6yy*cos(e5)^2*cos(e6)^2 + I6zz*cos(e4)^2*cos(e5)^2 + 2*I6xy*cos(e4)*cos(e5)*sin(e4) + 2*I5zx*cos(e4)*cos(e5)*sin(e4) + 2*I6zx*cos(e5)*cos(e6)*sin(e5) - I6xx*cos(e4)^2*cos(e5)^2*cos(e6)^2 + I6yy*cos(e4)^2*cos(e5)^2*cos(e6)^2 - 2*I5yz*cos(e4)*sin(e4)*sin(e5) - 2*I6yz*cos(e5)*sin(e5)*sin(e6) + 2*a2*a3*m4*cos(e3) + 2*a2*a3*m5*cos(e3) + 2*a2*a3*m6*cos(e3) - 2*a2*d4*m4*sin(e3) - 2*a2*d4*m5*sin(e3) - 2*a2*d4*m6*sin(e3) + 2*a2*m3*x3*cos(e3) + 2*a3*m4*x4*cos(e4) - 2*I5xy*cos(e4)^2*cos(e5)*sin(e5) - 2*I6xy*cos(e4)^2*cos(e6)*sin(e6) + 2*I6xy*cos(e5)^2*cos(e6)*sin(e6) + 2*d4*m5*y5*cos(e5) + 2*d4*m6*z6*cos(e5) - 2*a2*m3*y3*sin(e3) - 2*a3*m4*y4*sin(e4) - 2*a2*m4*z4*sin(e3) + 2*a3*m5*z5*sin(e4) + 2*d4*m5*x5*sin(e5) + m5*x5^2*cos(e4)^2*cos(e5)^2 + m6*x6^2*cos(e4)^2*cos(e6)^2 - m6*x6^2*cos(e5)^2*cos(e6)^2 - m5*y5^2*cos(e4)^2*cos(e5)^2 + m6*y6^2*cos(e4)^2*cos(e5)^2 - m6*y6^2*cos(e4)^2*cos(e6)^2 + m6*y6^2*cos(e5)^2*cos(e6)^2 - m4*x4*y4*sin(2*e4) + m5*x5*y5*sin(2*e5) - m6*z6^2*cos(e4)^2*cos(e5)^2 + m6*x6^2*cos(e4)^2*cos(e5)^2*cos(e6)^2 - m6*y6^2*cos(e4)^2*cos(e5)^2*cos(e6)^2 + 2*a2*m4*x4*cos(e3)*cos(e4) + 2*a3*m5*x5*cos(e4)*cos(e5) - 4*I6xy*cos(e4)*cos(e5)*cos(e6)^2*sin(e4) - 2*I6zx*cos(e4)^2*cos(e5)*cos(e6)*sin(e5) - 2*a2*m4*y4*cos(e3)*sin(e4) - 2*a2*m5*y5*cos(e5)*sin(e3) - 2*a3*m5*y5*cos(e4)*sin(e5) - 2*a3*m6*y6*cos(e6)*sin(e4) + 2*a2*m5*z5*cos(e3)*sin(e4) - 2*a2*m6*z6*cos(e5)*sin(e3) - 2*a3*m6*z6*cos(e4)*sin(e5) + 2*d4*m6*x6*cos(e6)*sin(e5) + 2*I6yz*cos(e4)^2*cos(e5)*sin(e5)*sin(e6) - 2*a2*m5*x5*sin(e3)*sin(e5) - 2*a3*m6*x6*sin(e4)*sin(e6) - 2*d4*m6*y6*sin(e5)*sin(e6) - 2*I6xy*cos(e4)^2*cos(e5)^2*cos(e6)*sin(e6) + 2*I6yz*cos(e4)*cos(e6)*sin(e4)*sin(e5) + 2*I6zx*cos(e4)*sin(e4)*sin(e5)*sin(e6) - 2*a2*m5*y5*cos(e3)*cos(e4)*sin(e5) - 2*a2*m6*y6*cos(e3)*cos(e6)*sin(e4) - 2*a3*m6*y6*cos(e4)*cos(e5)*sin(e6) - 2*a2*m6*z6*cos(e3)*cos(e4)*sin(e5) - 2*a2*m6*x6*cos(e3)*sin(e4)*sin(e6) - 2*a2*m6*x6*cos(e6)*sin(e3)*sin(e5) + 2*m6*x6*y6*cos(e4)*cos(e5)*sin(e4) + 2*m5*x5*z5*cos(e4)*cos(e5)*sin(e4) + 2*m6*x6*z6*cos(e5)*cos(e6)*sin(e5) + 2*a2*m6*y6*sin(e3)*sin(e5)*sin(e6) - 2*m5*y5*z5*cos(e4)*sin(e4)*sin(e5) - 2*m6*y6*z6*cos(e5)*sin(e5)*sin(e6) - 2*m5*x5*y5*cos(e4)^2*cos(e5)*sin(e5) - 2*m6*x6*y6*cos(e4)^2*cos(e6)*sin(e6) + 2*m6*x6*y6*cos(e5)^2*cos(e6)*sin(e6) + 2*I6xx*cos(e4)*cos(e5)*cos(e6)*sin(e4)*sin(e6) - 2*I6yy*cos(e4)*cos(e5)*cos(e6)*sin(e4)*sin(e6) + 2*a2*m5*x5*cos(e3)*cos(e4)*cos(e5) + 2*a3*m6*x6*cos(e4)*cos(e5)*cos(e6) + 2*m6*y6*z6*cos(e4)*cos(e6)*sin(e4)*sin(e5) + 2*m6*x6*z6*cos(e4)*sin(e4)*sin(e5)*sin(e6) - 4*m6*x6*y6*cos(e4)*cos(e5)*cos(e6)^2*sin(e4) - 2*m6*x6*z6*cos(e4)^2*cos(e5)*cos(e6)*sin(e5) + 2*m6*y6*z6*cos(e4)^2*cos(e5)*sin(e5)*sin(e6) - 2*m6*x6^2*cos(e4)*cos(e5)*cos(e6)*sin(e4)*sin(e6) - 2*m6*x6*y6*cos(e4)^2*cos(e5)^2*cos(e6)*sin(e6) + 2*m6*y6^2*cos(e4)*cos(e5)*cos(e6)*sin(e4)*sin(e6) + 2*a2*m6*x6*cos(e3)*cos(e4)*cos(e5)*cos(e6) - 2*a2*m6*y6*cos(e3)*cos(e4)*cos(e5)*sin(e6);
% M23 = I4xx + I5yy + I3zz + I6zz + a3^2*m4 + a3^2*m5 + a3^2*m6 + d4^2*m4 + d4^2*m5 + d4^2*m6 + m3*x3^2 + m5*x5^2 + m6*x6^2 + m3*y3^2 + m4*y4^2 + m6*y6^2 + m4*z4^2 + m5*z5^2 - I4xx*cos(e4)^2 + I5xx*cos(e5)^2 + I6xx*cos(e4)^2 + I4yy*cos(e4)^2 - I5yy*cos(e4)^2 - I5yy*cos(e5)^2 + I6yy*cos(e5)^2 + I5zz*cos(e4)^2 - I6zz*cos(e4)^2 - I6zz*cos(e5)^2 - I4xy*sin(2*e4) + I5xy*sin(2*e5) + 2*d4*m4*z4 + m4*x4^2*cos(e4)^2 - m5*x5^2*cos(e5)^2 - m6*x6^2*cos(e4)^2 - m4*y4^2*cos(e4)^2 + m5*y5^2*cos(e4)^2 + m5*y5^2*cos(e5)^2 - m6*y6^2*cos(e5)^2 - m5*z5^2*cos(e4)^2 + m6*z6^2*cos(e4)^2 + m6*z6^2*cos(e5)^2 - I5xx*cos(e4)^2*cos(e5)^2 - I6xx*cos(e4)^2*cos(e6)^2 + I6xx*cos(e5)^2*cos(e6)^2 + I5yy*cos(e4)^2*cos(e5)^2 - I6yy*cos(e4)^2*cos(e5)^2 + I6yy*cos(e4)^2*cos(e6)^2 - I6yy*cos(e5)^2*cos(e6)^2 + I6zz*cos(e4)^2*cos(e5)^2 + 2*I6xy*cos(e4)*cos(e5)*sin(e4) + 2*I5zx*cos(e4)*cos(e5)*sin(e4) + 2*I6zx*cos(e5)*cos(e6)*sin(e5) - I6xx*cos(e4)^2*cos(e5)^2*cos(e6)^2 + I6yy*cos(e4)^2*cos(e5)^2*cos(e6)^2 - 2*I5yz*cos(e4)*sin(e4)*sin(e5) - 2*I6yz*cos(e5)*sin(e5)*sin(e6) + a2*a3*m4*cos(e3) + a2*a3*m5*cos(e3) + a2*a3*m6*cos(e3) - a2*d4*m4*sin(e3) - a2*d4*m5*sin(e3) - a2*d4*m6*sin(e3) + a2*m3*x3*cos(e3) + 2*a3*m4*x4*cos(e4) - 2*I5xy*cos(e4)^2*cos(e5)*sin(e5) - 2*I6xy*cos(e4)^2*cos(e6)*sin(e6) + 2*I6xy*cos(e5)^2*cos(e6)*sin(e6) + 2*d4*m5*y5*cos(e5) + 2*d4*m6*z6*cos(e5) - a2*m3*y3*sin(e3) - 2*a3*m4*y4*sin(e4) - a2*m4*z4*sin(e3) + 2*a3*m5*z5*sin(e4) + 2*d4*m5*x5*sin(e5) + m5*x5^2*cos(e4)^2*cos(e5)^2 + m6*x6^2*cos(e4)^2*cos(e6)^2 - m6*x6^2*cos(e5)^2*cos(e6)^2 - m5*y5^2*cos(e4)^2*cos(e5)^2 + m6*y6^2*cos(e4)^2*cos(e5)^2 - m6*y6^2*cos(e4)^2*cos(e6)^2 + m6*y6^2*cos(e5)^2*cos(e6)^2 - m4*x4*y4*sin(2*e4) + m5*x5*y5*sin(2*e5) - m6*z6^2*cos(e4)^2*cos(e5)^2 + m6*x6^2*cos(e4)^2*cos(e5)^2*cos(e6)^2 - m6*y6^2*cos(e4)^2*cos(e5)^2*cos(e6)^2 + a2*m4*x4*cos(e3)*cos(e4) + 2*a3*m5*x5*cos(e4)*cos(e5) - 4*I6xy*cos(e4)*cos(e5)*cos(e6)^2*sin(e4) - 2*I6zx*cos(e4)^2*cos(e5)*cos(e6)*sin(e5) - a2*m4*y4*cos(e3)*sin(e4) - a2*m5*y5*cos(e5)*sin(e3) - 2*a3*m5*y5*cos(e4)*sin(e5) - 2*a3*m6*y6*cos(e6)*sin(e4) + a2*m5*z5*cos(e3)*sin(e4) - a2*m6*z6*cos(e5)*sin(e3) - 2*a3*m6*z6*cos(e4)*sin(e5) + 2*d4*m6*x6*cos(e6)*sin(e5) + 2*I6yz*cos(e4)^2*cos(e5)*sin(e5)*sin(e6) - a2*m5*x5*sin(e3)*sin(e5) - 2*a3*m6*x6*sin(e4)*sin(e6) - 2*d4*m6*y6*sin(e5)*sin(e6) - 2*I6xy*cos(e4)^2*cos(e5)^2*cos(e6)*sin(e6) + 2*I6yz*cos(e4)*cos(e6)*sin(e4)*sin(e5) + 2*I6zx*cos(e4)*sin(e4)*sin(e5)*sin(e6) - a2*m5*y5*cos(e3)*cos(e4)*sin(e5) - a2*m6*y6*cos(e3)*cos(e6)*sin(e4) - 2*a3*m6*y6*cos(e4)*cos(e5)*sin(e6) - a2*m6*z6*cos(e3)*cos(e4)*sin(e5) - a2*m6*x6*cos(e3)*sin(e4)*sin(e6) - a2*m6*x6*cos(e6)*sin(e3)*sin(e5) + 2*m6*x6*y6*cos(e4)*cos(e5)*sin(e4) + 2*m5*x5*z5*cos(e4)*cos(e5)*sin(e4) + 2*m6*x6*z6*cos(e5)*cos(e6)*sin(e5) + a2*m6*y6*sin(e3)*sin(e5)*sin(e6) - 2*m5*y5*z5*cos(e4)*sin(e4)*sin(e5) - 2*m6*y6*z6*cos(e5)*sin(e5)*sin(e6) - 2*m5*x5*y5*cos(e4)^2*cos(e5)*sin(e5) - 2*m6*x6*y6*cos(e4)^2*cos(e6)*sin(e6) + 2*m6*x6*y6*cos(e5)^2*cos(e6)*sin(e6) + 2*I6xx*cos(e4)*cos(e5)*cos(e6)*sin(e4)*sin(e6) - 2*I6yy*cos(e4)*cos(e5)*cos(e6)*sin(e4)*sin(e6) + a2*m5*x5*cos(e3)*cos(e4)*cos(e5) + 2*a3*m6*x6*cos(e4)*cos(e5)*cos(e6) + 2*m6*y6*z6*cos(e4)*cos(e6)*sin(e4)*sin(e5) + 2*m6*x6*z6*cos(e4)*sin(e4)*sin(e5)*sin(e6) - 4*m6*x6*y6*cos(e4)*cos(e5)*cos(e6)^2*sin(e4) - 2*m6*x6*z6*cos(e4)^2*cos(e5)*cos(e6)*sin(e5) + 2*m6*y6*z6*cos(e4)^2*cos(e5)*sin(e5)*sin(e6) - 2*m6*x6^2*cos(e4)*cos(e5)*cos(e6)*sin(e4)*sin(e6) - 2*m6*x6*y6*cos(e4)^2*cos(e5)^2*cos(e6)*sin(e6) + 2*m6*y6^2*cos(e4)*cos(e5)*cos(e6)*sin(e4)*sin(e6) + a2*m6*x6*cos(e3)*cos(e4)*cos(e5)*cos(e6) - a2*m6*y6*cos(e3)*cos(e4)*cos(e5)*sin(e6);
% M24 = I4yz*cos(e4) - I5xy*sin(e4) + I4zx*sin(e4) - I5yz*cos(e4)*cos(e5) - I6xy*cos(e4)*sin(e5) - I5zx*cos(e4)*sin(e5) - I6zx*cos(e6)*sin(e4) + I6yz*sin(e4)*sin(e6) + 2*I5xy*cos(e5)^2*sin(e4) + I6yz*cos(e4)*cos(e5)*cos(e6) + I6zx*cos(e4)*cos(e5)*sin(e6) - I5xx*cos(e5)*sin(e4)*sin(e5) + I5yy*cos(e5)*sin(e4)*sin(e5) - I6yy*cos(e5)*sin(e4)*sin(e5) + I6zz*cos(e5)*sin(e4)*sin(e5) + 2*I6xy*cos(e4)*cos(e6)^2*sin(e5) + 2*I6zx*cos(e5)^2*cos(e6)*sin(e4) + d4*m4*y4*cos(e4) - d4*m5*z5*cos(e4) + d4*m4*x4*sin(e4) - 2*I6yz*cos(e5)^2*sin(e4)*sin(e6) + m4*y4*z4*cos(e4) - m5*x5*y5*sin(e4) + m4*x4*z4*sin(e4) + m5*x5^2*cos(e5)*sin(e4)*sin(e5) - m5*y5^2*cos(e5)*sin(e4)*sin(e5) + m6*y6^2*cos(e5)*sin(e4)*sin(e5) - m6*z6^2*cos(e5)*sin(e4)*sin(e5) + d4*m6*y6*cos(e4)*cos(e6) - a2*m4*y4*cos(e4)*sin(e3) + a2*m5*z5*cos(e4)*sin(e3) + d4*m5*x5*cos(e5)*sin(e4) + d4*m6*x6*cos(e4)*sin(e6) - I6xx*cos(e5)*cos(e6)^2*sin(e4)*sin(e5) + I6yy*cos(e5)*cos(e6)^2*sin(e4)*sin(e5) - m5*y5*z5*cos(e4)*cos(e5) - a2*m4*x4*sin(e3)*sin(e4) - d4*m5*y5*sin(e4)*sin(e5) - d4*m6*z6*sin(e4)*sin(e5) - m6*x6*y6*cos(e4)*sin(e5) - m5*x5*z5*cos(e4)*sin(e5) - m6*x6*z6*cos(e6)*sin(e4) + m6*y6*z6*sin(e4)*sin(e6) + 2*m5*x5*y5*cos(e5)^2*sin(e4) - I6xx*cos(e4)*cos(e6)*sin(e5)*sin(e6) + I6yy*cos(e4)*cos(e6)*sin(e5)*sin(e6) - a2*m6*y6*cos(e4)*cos(e6)*sin(e3) + d4*m6*x6*cos(e5)*cos(e6)*sin(e4) + m6*y6*z6*cos(e4)*cos(e5)*cos(e6) - a2*m5*x5*cos(e5)*sin(e3)*sin(e4) - a2*m6*x6*cos(e4)*sin(e3)*sin(e6) - d4*m6*y6*cos(e5)*sin(e4)*sin(e6) + m6*x6*z6*cos(e4)*cos(e5)*sin(e6) + a2*m5*y5*sin(e3)*sin(e4)*sin(e5) + a2*m6*z6*sin(e3)*sin(e4)*sin(e5) + m6*x6^2*cos(e5)*cos(e6)^2*sin(e4)*sin(e5) - m6*y6^2*cos(e5)*cos(e6)^2*sin(e4)*sin(e5) + 2*m6*x6*y6*cos(e4)*cos(e6)^2*sin(e5) + 2*m6*x6*z6*cos(e5)^2*cos(e6)*sin(e4) - 2*m6*y6*z6*cos(e5)^2*sin(e4)*sin(e6) - 2*I6xy*cos(e5)*cos(e6)*sin(e4)*sin(e5)*sin(e6) + m6*x6^2*cos(e4)*cos(e6)*sin(e5)*sin(e6) - m6*y6^2*cos(e4)*cos(e6)*sin(e5)*sin(e6) - a2*m6*x6*cos(e5)*cos(e6)*sin(e3)*sin(e4) + a2*m6*y6*cos(e5)*sin(e3)*sin(e4)*sin(e6) - 2*m6*x6*y6*cos(e5)*cos(e6)*sin(e4)*sin(e5)*sin(e6);
% M25 = I6xx*cos(e4) + I5zz*cos(e4) + I6xy*cos(e5)*sin(e4) + I5zx*cos(e5)*sin(e4) - I5yz*sin(e4)*sin(e5) + m5*x5^2*cos(e4) + m5*y5^2*cos(e4) + m6*y6^2*cos(e4) + m6*z6^2*cos(e4) - I6xx*cos(e4)*cos(e6)^2 + I6yy*cos(e4)*cos(e6)^2 - 2*I6xy*cos(e4)*cos(e6)*sin(e6) + I6yz*cos(e6)*sin(e4)*sin(e5) + I6zx*sin(e4)*sin(e5)*sin(e6) + a3*m5*x5*cos(e5) - 2*I6xy*cos(e5)*cos(e6)^2*sin(e4) - a3*m5*y5*sin(e5) - a3*m6*z6*sin(e5) + m6*x6^2*cos(e4)*cos(e6)^2 - m6*y6^2*cos(e4)*cos(e6)^2 + a2*m5*x5*cos(e3)*cos(e5) + a3*m6*x6*cos(e5)*cos(e6) + d4*m5*y5*cos(e4)*cos(e5) + d4*m6*z6*cos(e4)*cos(e5) - a2*m5*y5*cos(e3)*sin(e5) - a3*m6*y6*cos(e5)*sin(e6) - a2*m6*z6*cos(e3)*sin(e5) + d4*m5*x5*cos(e4)*sin(e5) + m6*x6*y6*cos(e5)*sin(e4) + m5*x5*z5*cos(e5)*sin(e4) - m5*y5*z5*sin(e4)*sin(e5) + I6xx*cos(e5)*cos(e6)*sin(e4)*sin(e6) - I6yy*cos(e5)*cos(e6)*sin(e4)*sin(e6) - a2*m5*y5*cos(e4)*cos(e5)*sin(e3) - a2*m6*y6*cos(e3)*cos(e5)*sin(e6) - a2*m6*z6*cos(e4)*cos(e5)*sin(e3) + d4*m6*x6*cos(e4)*cos(e6)*sin(e5) - a2*m5*x5*cos(e4)*sin(e3)*sin(e5) - d4*m6*y6*cos(e4)*sin(e5)*sin(e6) - 2*m6*x6*y6*cos(e4)*cos(e6)*sin(e6) + m6*y6*z6*cos(e6)*sin(e4)*sin(e5) + m6*x6*z6*sin(e4)*sin(e5)*sin(e6) - 2*m6*x6*y6*cos(e5)*cos(e6)^2*sin(e4) - m6*x6^2*cos(e5)*cos(e6)*sin(e4)*sin(e6) + m6*y6^2*cos(e5)*cos(e6)*sin(e4)*sin(e6) + a2*m6*x6*cos(e3)*cos(e5)*cos(e6) - a2*m6*x6*cos(e4)*cos(e6)*sin(e3)*sin(e5) + a2*m6*y6*cos(e4)*sin(e3)*sin(e5)*sin(e6);
% M26 = I6yz*cos(e4)*cos(e6) + I6zx*cos(e4)*sin(e6) + I6zz*sin(e4)*sin(e5) + I6zx*cos(e5)*cos(e6)*sin(e4) - I6yz*cos(e5)*sin(e4)*sin(e6) + m6*x6^2*sin(e4)*sin(e5) + m6*y6^2*sin(e4)*sin(e5) - a3*m6*y6*cos(e6)*sin(e5) + d4*m6*x6*cos(e6)*sin(e4) + m6*y6*z6*cos(e4)*cos(e6) - a3*m6*x6*sin(e5)*sin(e6) - d4*m6*y6*sin(e4)*sin(e6) + m6*x6*z6*cos(e4)*sin(e6) + d4*m6*y6*cos(e4)*cos(e5)*cos(e6) - a2*m6*y6*cos(e3)*cos(e6)*sin(e5) + d4*m6*x6*cos(e4)*cos(e5)*sin(e6) - a2*m6*x6*cos(e6)*sin(e3)*sin(e4) - a2*m6*x6*cos(e3)*sin(e5)*sin(e6) + m6*x6*z6*cos(e5)*cos(e6)*sin(e4) + a2*m6*y6*sin(e3)*sin(e4)*sin(e6) - m6*y6*z6*cos(e5)*sin(e4)*sin(e6) - a2*m6*y6*cos(e4)*cos(e5)*cos(e6)*sin(e3) - a2*m6*x6*cos(e4)*cos(e5)*sin(e3)*sin(e6);
% 
% M31 = (I5zx*cos(e4) + I5xx*cos(e5)*sin(e4) + I5xy*sin(e4)*sin(e5))*(cos(e2)*sin(e3)*sin(e5) + cos(e3)*sin(e2)*sin(e5) - cos(e2)*cos(e3)*cos(e4)*cos(e5) + cos(e4)*cos(e5)*sin(e2)*sin(e3)) - (I5xy*cos(e5)*sin(e4) - I5yz*cos(e4) + I5yy*sin(e4)*sin(e5))*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5)) - I3zx*cos(e2 + e3) + I3yz*sin(e2 + e3) - sin(e2 + e3)*(I4yz*cos(e4) + I4zx*sin(e4)) + (I6xx*(cos(e4)*sin(e6) + cos(e5)*cos(e6)*sin(e4)) - I6xy*(cos(e4)*cos(e6) - cos(e5)*sin(e4)*sin(e6)) + I6zx*sin(e4)*sin(e5))*(cos(e2)*cos(e3)*sin(e4)*sin(e6) + cos(e2)*cos(e6)*sin(e3)*sin(e5) + cos(e3)*cos(e6)*sin(e2)*sin(e5) - sin(e2)*sin(e3)*sin(e4)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*cos(e6) + cos(e4)*cos(e5)*cos(e6)*sin(e2)*sin(e3)) - (I6yy*(cos(e4)*cos(e6) - cos(e5)*sin(e4)*sin(e6)) - I6xy*(cos(e4)*sin(e6) + cos(e5)*cos(e6)*sin(e4)) + I6yz*sin(e4)*sin(e5))*(cos(e6)*sin(e2)*sin(e3)*sin(e4) - cos(e2)*cos(e3)*cos(e6)*sin(e4) + cos(e2)*sin(e3)*sin(e5)*sin(e6) + cos(e3)*sin(e2)*sin(e5)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*sin(e6) + cos(e4)*cos(e5)*sin(e2)*sin(e3)*sin(e6)) + (I4xy*cos(e4) - I4xx*sin(e4))*(cos(e2)*cos(e3)*cos(e4) - cos(e4)*sin(e2)*sin(e3)) + (cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4))*(I4yy*cos(e4) - I4xy*sin(e4)) + (cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4))*(I5zz*cos(e4) + I5zx*cos(e5)*sin(e4) - I5yz*sin(e4)*sin(e5)) - (I6yz*(cos(e4)*cos(e6) - cos(e5)*sin(e4)*sin(e6)) + I6zx*(cos(e4)*sin(e6) + cos(e5)*cos(e6)*sin(e4)) + I6zz*sin(e4)*sin(e5))*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5)) + m5*(sin(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) + z5*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - x5*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5)) + y5*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)))*(x5*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) + y5*(sin(e2 + e3)*cos(e1)*cos(e5) + cos(e2 + e3)*cos(e1)*cos(e4)*sin(e5)) - cos(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3)) - z5*cos(e2 + e3)*cos(e1)*sin(e4)) - m4*(sin(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) - x4*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - y4*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) + z4*cos(e2 + e3)*sin(e1))*(cos(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3)) - z4*sin(e2 + e3)*cos(e1) - y4*cos(e2 + e3)*cos(e1)*sin(e4) + x4*cos(e2 + e3)*cos(e1)*cos(e4)) - m5*(x5*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) + y5*(sin(e2 + e3)*cos(e5)*sin(e1) + cos(e2 + e3)*cos(e4)*sin(e1)*sin(e5)) - sin(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3)) - z5*cos(e2 + e3)*sin(e1)*sin(e4))*(cos(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) - z5*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + x5*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5)) - y5*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5))) + m4*(sin(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3)) - z4*sin(e2 + e3)*sin(e1) + x4*cos(e2 + e3)*cos(e4)*sin(e1) - y4*cos(e2 + e3)*sin(e1)*sin(e4))*(cos(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) + x4*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + y4*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + z4*cos(e2 + e3)*cos(e1)) + m6*(sin(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) - x6*(sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) + cos(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) - y6*(cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - sin(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) + z6*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)))*(x6*(cos(e6)*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) + cos(e2 + e3)*cos(e1)*sin(e4)*sin(e6)) - y6*(sin(e6)*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) - cos(e2 + e3)*cos(e1)*cos(e6)*sin(e4)) + z6*(sin(e2 + e3)*cos(e1)*cos(e5) + cos(e2 + e3)*cos(e1)*cos(e4)*sin(e5)) - cos(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3))) - m3*(x3*cos(e2 + e3)*cos(e1) - y3*sin(e2 + e3)*cos(e1))*(sin(e1)*(a1 + a2*sin(e2)) + z3*cos(e1) + y3*cos(e2 + e3)*sin(e1) + x3*sin(e2 + e3)*sin(e1)) + m3*(x3*cos(e2 + e3)*sin(e1) - y3*sin(e2 + e3)*sin(e1))*(cos(e1)*(a1 + a2*sin(e2)) - z3*sin(e1) + y3*cos(e2 + e3)*cos(e1) + x3*sin(e2 + e3)*cos(e1)) - m6*(x6*(cos(e6)*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) + cos(e2 + e3)*sin(e1)*sin(e4)*sin(e6)) - y6*(sin(e6)*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) - cos(e2 + e3)*cos(e6)*sin(e1)*sin(e4)) + z6*(sin(e2 + e3)*cos(e5)*sin(e1) + cos(e2 + e3)*cos(e4)*sin(e1)*sin(e5)) - sin(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3)))*(cos(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) + x6*(sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + cos(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) + y6*(cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - sin(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) - z6*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5)));
% M32 = I4xx + I5yy + I3zz + I6zz + a3^2*m4 + a3^2*m5 + a3^2*m6 + d4^2*m4 + d4^2*m5 + d4^2*m6 + m3*x3^2 + m5*x5^2 + m6*x6^2 + m3*y3^2 + m4*y4^2 + m6*y6^2 + m4*z4^2 + m5*z5^2 - I4xx*cos(e4)^2 + I5xx*cos(e5)^2 + I6xx*cos(e4)^2 + I4yy*cos(e4)^2 - I5yy*cos(e4)^2 - I5yy*cos(e5)^2 + I6yy*cos(e5)^2 + I5zz*cos(e4)^2 - I6zz*cos(e4)^2 - I6zz*cos(e5)^2 - I4xy*sin(2*e4) + I5xy*sin(2*e5) + 2*d4*m4*z4 + m4*x4^2*cos(e4)^2 - m5*x5^2*cos(e5)^2 - m6*x6^2*cos(e4)^2 - m4*y4^2*cos(e4)^2 + m5*y5^2*cos(e4)^2 + m5*y5^2*cos(e5)^2 - m6*y6^2*cos(e5)^2 - m5*z5^2*cos(e4)^2 + m6*z6^2*cos(e4)^2 + m6*z6^2*cos(e5)^2 - I5xx*cos(e4)^2*cos(e5)^2 - I6xx*cos(e4)^2*cos(e6)^2 + I6xx*cos(e5)^2*cos(e6)^2 + I5yy*cos(e4)^2*cos(e5)^2 - I6yy*cos(e4)^2*cos(e5)^2 + I6yy*cos(e4)^2*cos(e6)^2 - I6yy*cos(e5)^2*cos(e6)^2 + I6zz*cos(e4)^2*cos(e5)^2 + 2*I6xy*cos(e4)*cos(e5)*sin(e4) + 2*I5zx*cos(e4)*cos(e5)*sin(e4) + 2*I6zx*cos(e5)*cos(e6)*sin(e5) - I6xx*cos(e4)^2*cos(e5)^2*cos(e6)^2 + I6yy*cos(e4)^2*cos(e5)^2*cos(e6)^2 - 2*I5yz*cos(e4)*sin(e4)*sin(e5) - 2*I6yz*cos(e5)*sin(e5)*sin(e6) + a2*a3*m4*cos(e3) + a2*a3*m5*cos(e3) + a2*a3*m6*cos(e3) - a2*d4*m4*sin(e3) - a2*d4*m5*sin(e3) - a2*d4*m6*sin(e3) + a2*m3*x3*cos(e3) + 2*a3*m4*x4*cos(e4) - 2*I5xy*cos(e4)^2*cos(e5)*sin(e5) - 2*I6xy*cos(e4)^2*cos(e6)*sin(e6) + 2*I6xy*cos(e5)^2*cos(e6)*sin(e6) + 2*d4*m5*y5*cos(e5) + 2*d4*m6*z6*cos(e5) - a2*m3*y3*sin(e3) - 2*a3*m4*y4*sin(e4) - a2*m4*z4*sin(e3) + 2*a3*m5*z5*sin(e4) + 2*d4*m5*x5*sin(e5) + m5*x5^2*cos(e4)^2*cos(e5)^2 + m6*x6^2*cos(e4)^2*cos(e6)^2 - m6*x6^2*cos(e5)^2*cos(e6)^2 - m5*y5^2*cos(e4)^2*cos(e5)^2 + m6*y6^2*cos(e4)^2*cos(e5)^2 - m6*y6^2*cos(e4)^2*cos(e6)^2 + m6*y6^2*cos(e5)^2*cos(e6)^2 - m4*x4*y4*sin(2*e4) + m5*x5*y5*sin(2*e5) - m6*z6^2*cos(e4)^2*cos(e5)^2 + m6*x6^2*cos(e4)^2*cos(e5)^2*cos(e6)^2 - m6*y6^2*cos(e4)^2*cos(e5)^2*cos(e6)^2 + a2*m4*x4*cos(e3)*cos(e4) + 2*a3*m5*x5*cos(e4)*cos(e5) - 4*I6xy*cos(e4)*cos(e5)*cos(e6)^2*sin(e4) - 2*I6zx*cos(e4)^2*cos(e5)*cos(e6)*sin(e5) - a2*m4*y4*cos(e3)*sin(e4) - a2*m5*y5*cos(e5)*sin(e3) - 2*a3*m5*y5*cos(e4)*sin(e5) - 2*a3*m6*y6*cos(e6)*sin(e4) + a2*m5*z5*cos(e3)*sin(e4) - a2*m6*z6*cos(e5)*sin(e3) - 2*a3*m6*z6*cos(e4)*sin(e5) + 2*d4*m6*x6*cos(e6)*sin(e5) + 2*I6yz*cos(e4)^2*cos(e5)*sin(e5)*sin(e6) - a2*m5*x5*sin(e3)*sin(e5) - 2*a3*m6*x6*sin(e4)*sin(e6) - 2*d4*m6*y6*sin(e5)*sin(e6) - 2*I6xy*cos(e4)^2*cos(e5)^2*cos(e6)*sin(e6) + 2*I6yz*cos(e4)*cos(e6)*sin(e4)*sin(e5) + 2*I6zx*cos(e4)*sin(e4)*sin(e5)*sin(e6) - a2*m5*y5*cos(e3)*cos(e4)*sin(e5) - a2*m6*y6*cos(e3)*cos(e6)*sin(e4) - 2*a3*m6*y6*cos(e4)*cos(e5)*sin(e6) - a2*m6*z6*cos(e3)*cos(e4)*sin(e5) - a2*m6*x6*cos(e3)*sin(e4)*sin(e6) - a2*m6*x6*cos(e6)*sin(e3)*sin(e5) + 2*m6*x6*y6*cos(e4)*cos(e5)*sin(e4) + 2*m5*x5*z5*cos(e4)*cos(e5)*sin(e4) + 2*m6*x6*z6*cos(e5)*cos(e6)*sin(e5) + a2*m6*y6*sin(e3)*sin(e5)*sin(e6) - 2*m5*y5*z5*cos(e4)*sin(e4)*sin(e5) - 2*m6*y6*z6*cos(e5)*sin(e5)*sin(e6) - 2*m5*x5*y5*cos(e4)^2*cos(e5)*sin(e5) - 2*m6*x6*y6*cos(e4)^2*cos(e6)*sin(e6) + 2*m6*x6*y6*cos(e5)^2*cos(e6)*sin(e6) + 2*I6xx*cos(e4)*cos(e5)*cos(e6)*sin(e4)*sin(e6) - 2*I6yy*cos(e4)*cos(e5)*cos(e6)*sin(e4)*sin(e6) + a2*m5*x5*cos(e3)*cos(e4)*cos(e5) + 2*a3*m6*x6*cos(e4)*cos(e5)*cos(e6) + 2*m6*y6*z6*cos(e4)*cos(e6)*sin(e4)*sin(e5) + 2*m6*x6*z6*cos(e4)*sin(e4)*sin(e5)*sin(e6) - 4*m6*x6*y6*cos(e4)*cos(e5)*cos(e6)^2*sin(e4) - 2*m6*x6*z6*cos(e4)^2*cos(e5)*cos(e6)*sin(e5) + 2*m6*y6*z6*cos(e4)^2*cos(e5)*sin(e5)*sin(e6) - 2*m6*x6^2*cos(e4)*cos(e5)*cos(e6)*sin(e4)*sin(e6) - 2*m6*x6*y6*cos(e4)^2*cos(e5)^2*cos(e6)*sin(e6) + 2*m6*y6^2*cos(e4)*cos(e5)*cos(e6)*sin(e4)*sin(e6) + a2*m6*x6*cos(e3)*cos(e4)*cos(e5)*cos(e6) - a2*m6*y6*cos(e3)*cos(e4)*cos(e5)*sin(e6);
% M33 = I4xx + I5yy + I3zz + I6zz + a3^2*m4 + a3^2*m5 + a3^2*m6 + d4^2*m4 + d4^2*m5 + d4^2*m6 + m3*x3^2 + m5*x5^2 + m6*x6^2 + m3*y3^2 + m4*y4^2 + m6*y6^2 + m4*z4^2 + m5*z5^2 - I4xx*cos(e4)^2 + I5xx*cos(e5)^2 + I6xx*cos(e4)^2 + I4yy*cos(e4)^2 - I5yy*cos(e4)^2 - I5yy*cos(e5)^2 + I6yy*cos(e5)^2 + I5zz*cos(e4)^2 - I6zz*cos(e4)^2 - I6zz*cos(e5)^2 - I4xy*sin(2*e4) + I5xy*sin(2*e5) + 2*d4*m4*z4 + m4*x4^2*cos(e4)^2 - m5*x5^2*cos(e5)^2 - m6*x6^2*cos(e4)^2 - m4*y4^2*cos(e4)^2 + m5*y5^2*cos(e4)^2 + m5*y5^2*cos(e5)^2 - m6*y6^2*cos(e5)^2 - m5*z5^2*cos(e4)^2 + m6*z6^2*cos(e4)^2 + m6*z6^2*cos(e5)^2 - I5xx*cos(e4)^2*cos(e5)^2 - I6xx*cos(e4)^2*cos(e6)^2 + I6xx*cos(e5)^2*cos(e6)^2 + I5yy*cos(e4)^2*cos(e5)^2 - I6yy*cos(e4)^2*cos(e5)^2 + I6yy*cos(e4)^2*cos(e6)^2 - I6yy*cos(e5)^2*cos(e6)^2 + I6zz*cos(e4)^2*cos(e5)^2 + 2*I6xy*cos(e4)*cos(e5)*sin(e4) + 2*I5zx*cos(e4)*cos(e5)*sin(e4) + 2*I6zx*cos(e5)*cos(e6)*sin(e5) - I6xx*cos(e4)^2*cos(e5)^2*cos(e6)^2 + I6yy*cos(e4)^2*cos(e5)^2*cos(e6)^2 - 2*I5yz*cos(e4)*sin(e4)*sin(e5) - 2*I6yz*cos(e5)*sin(e5)*sin(e6) + 2*a3*m4*x4*cos(e4) - 2*I5xy*cos(e4)^2*cos(e5)*sin(e5) - 2*I6xy*cos(e4)^2*cos(e6)*sin(e6) + 2*I6xy*cos(e5)^2*cos(e6)*sin(e6) + 2*d4*m5*y5*cos(e5) + 2*d4*m6*z6*cos(e5) - 2*a3*m4*y4*sin(e4) + 2*a3*m5*z5*sin(e4) + 2*d4*m5*x5*sin(e5) + m5*x5^2*cos(e4)^2*cos(e5)^2 + m6*x6^2*cos(e4)^2*cos(e6)^2 - m6*x6^2*cos(e5)^2*cos(e6)^2 - m5*y5^2*cos(e4)^2*cos(e5)^2 + m6*y6^2*cos(e4)^2*cos(e5)^2 - m6*y6^2*cos(e4)^2*cos(e6)^2 + m6*y6^2*cos(e5)^2*cos(e6)^2 - m4*x4*y4*sin(2*e4) + m5*x5*y5*sin(2*e5) - m6*z6^2*cos(e4)^2*cos(e5)^2 + m6*x6^2*cos(e4)^2*cos(e5)^2*cos(e6)^2 - m6*y6^2*cos(e4)^2*cos(e5)^2*cos(e6)^2 + 2*a3*m5*x5*cos(e4)*cos(e5) - 4*I6xy*cos(e4)*cos(e5)*cos(e6)^2*sin(e4) - 2*I6zx*cos(e4)^2*cos(e5)*cos(e6)*sin(e5) - 2*a3*m5*y5*cos(e4)*sin(e5) - 2*a3*m6*y6*cos(e6)*sin(e4) - 2*a3*m6*z6*cos(e4)*sin(e5) + 2*d4*m6*x6*cos(e6)*sin(e5) + 2*I6yz*cos(e4)^2*cos(e5)*sin(e5)*sin(e6) - 2*a3*m6*x6*sin(e4)*sin(e6) - 2*d4*m6*y6*sin(e5)*sin(e6) - 2*I6xy*cos(e4)^2*cos(e5)^2*cos(e6)*sin(e6) + 2*I6yz*cos(e4)*cos(e6)*sin(e4)*sin(e5) + 2*I6zx*cos(e4)*sin(e4)*sin(e5)*sin(e6) - 2*a3*m6*y6*cos(e4)*cos(e5)*sin(e6) + 2*m6*x6*y6*cos(e4)*cos(e5)*sin(e4) + 2*m5*x5*z5*cos(e4)*cos(e5)*sin(e4) + 2*m6*x6*z6*cos(e5)*cos(e6)*sin(e5) - 2*m5*y5*z5*cos(e4)*sin(e4)*sin(e5) - 2*m6*y6*z6*cos(e5)*sin(e5)*sin(e6) - 2*m5*x5*y5*cos(e4)^2*cos(e5)*sin(e5) - 2*m6*x6*y6*cos(e4)^2*cos(e6)*sin(e6) + 2*m6*x6*y6*cos(e5)^2*cos(e6)*sin(e6) + 2*I6xx*cos(e4)*cos(e5)*cos(e6)*sin(e4)*sin(e6) - 2*I6yy*cos(e4)*cos(e5)*cos(e6)*sin(e4)*sin(e6) + 2*a3*m6*x6*cos(e4)*cos(e5)*cos(e6) + 2*m6*y6*z6*cos(e4)*cos(e6)*sin(e4)*sin(e5) + 2*m6*x6*z6*cos(e4)*sin(e4)*sin(e5)*sin(e6) - 4*m6*x6*y6*cos(e4)*cos(e5)*cos(e6)^2*sin(e4) - 2*m6*x6*z6*cos(e4)^2*cos(e5)*cos(e6)*sin(e5) + 2*m6*y6*z6*cos(e4)^2*cos(e5)*sin(e5)*sin(e6) - 2*m6*x6^2*cos(e4)*cos(e5)*cos(e6)*sin(e4)*sin(e6) - 2*m6*x6*y6*cos(e4)^2*cos(e5)^2*cos(e6)*sin(e6) + 2*m6*y6^2*cos(e4)*cos(e5)*cos(e6)*sin(e4)*sin(e6);
% M34 = I4yz*cos(e4) + I4zx*sin(e4) + cos(e5)*(I6yz*(cos(e4)*cos(e6) - cos(e5)*sin(e4)*sin(e6)) + I6zx*(cos(e4)*sin(e6) + cos(e5)*cos(e6)*sin(e4)) + I6zz*sin(e4)*sin(e5)) + cos(e5)*(I5xy*cos(e5)*sin(e4) - I5yz*cos(e4) + I5yy*sin(e4)*sin(e5)) - sin(e5)*(I5zx*cos(e4) + I5xx*cos(e5)*sin(e4) + I5xy*sin(e4)*sin(e5)) - m5*(z5*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + x5*cos(e5)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - y5*sin(e5)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)))*(x5*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) + y5*(sin(e2 + e3)*cos(e1)*cos(e5) + cos(e2 + e3)*cos(e1)*cos(e4)*sin(e5)) - cos(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3)) - z5*cos(e2 + e3)*cos(e1)*sin(e4)) + m6*(x6*(sin(e6)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e5)*cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4))) + y6*(cos(e6)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e5)*sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4))) + z6*sin(e5)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)))*(x6*(cos(e6)*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) + cos(e2 + e3)*cos(e1)*sin(e4)*sin(e6)) - y6*(sin(e6)*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) - cos(e2 + e3)*cos(e1)*cos(e6)*sin(e4)) + z6*(sin(e2 + e3)*cos(e1)*cos(e5) + cos(e2 + e3)*cos(e1)*cos(e4)*sin(e5)) - cos(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3))) - cos(e6)*sin(e5)*(I6xx*(cos(e4)*sin(e6) + cos(e5)*cos(e6)*sin(e4)) - I6xy*(cos(e4)*cos(e6) - cos(e5)*sin(e4)*sin(e6)) + I6zx*sin(e4)*sin(e5)) + sin(e5)*sin(e6)*(I6yy*(cos(e4)*cos(e6) - cos(e5)*sin(e4)*sin(e6)) - I6xy*(cos(e4)*sin(e6) + cos(e5)*cos(e6)*sin(e4)) + I6yz*sin(e4)*sin(e5)) + m5*(z5*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + x5*cos(e5)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - y5*sin(e5)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)))*(x5*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) + y5*(sin(e2 + e3)*cos(e5)*sin(e1) + cos(e2 + e3)*cos(e4)*sin(e1)*sin(e5)) - sin(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3)) - z5*cos(e2 + e3)*sin(e1)*sin(e4)) + m6*(x6*(cos(e2 + e3)*cos(e4)*sin(e6) + cos(e2 + e3)*cos(e5)*cos(e6)*sin(e4)) + y6*(cos(e2 + e3)*cos(e4)*cos(e6) - cos(e2 + e3)*cos(e5)*sin(e4)*sin(e6)) - z6*cos(e2 + e3)*sin(e4)*sin(e5))*(d4*cos(e2 + e3) + a3*sin(e2 + e3) + z6*(cos(e2 + e3)*cos(e5) - sin(e2 + e3)*cos(e4)*sin(e5)) + x6*(cos(e6)*(cos(e2 + e3)*sin(e5) + sin(e2 + e3)*cos(e4)*cos(e5)) - sin(e2 + e3)*sin(e4)*sin(e6)) - y6*(sin(e6)*(cos(e2 + e3)*sin(e5) + sin(e2 + e3)*cos(e4)*cos(e5)) + sin(e2 + e3)*cos(e6)*sin(e4))) + m4*(y4*cos(e2 + e3)*cos(e4) + x4*cos(e2 + e3)*sin(e4))*(d4*cos(e2 + e3) + a3*sin(e2 + e3) + z4*cos(e2 + e3) + x4*sin(e2 + e3)*cos(e4) - y4*sin(e2 + e3)*sin(e4)) + m4*(x4*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - y4*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)))*(cos(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3)) - z4*sin(e2 + e3)*cos(e1) - y4*cos(e2 + e3)*cos(e1)*sin(e4) + x4*cos(e2 + e3)*cos(e1)*cos(e4)) - m6*(x6*(sin(e6)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e5)*cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4))) + y6*(cos(e6)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e5)*sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4))) + z6*sin(e5)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)))*(x6*(cos(e6)*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) + cos(e2 + e3)*sin(e1)*sin(e4)*sin(e6)) - y6*(sin(e6)*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) - cos(e2 + e3)*cos(e6)*sin(e1)*sin(e4)) + z6*(sin(e2 + e3)*cos(e5)*sin(e1) + cos(e2 + e3)*cos(e4)*sin(e1)*sin(e5)) - sin(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3))) - m4*(x4*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - y4*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)))*(sin(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3)) - z4*sin(e2 + e3)*sin(e1) + x4*cos(e2 + e3)*cos(e4)*sin(e1) - y4*cos(e2 + e3)*sin(e1)*sin(e4)) - m5*(z5*cos(e2 + e3)*cos(e4) - x5*cos(e2 + e3)*cos(e5)*sin(e4) + y5*cos(e2 + e3)*sin(e4)*sin(e5))*(d4*cos(e2 + e3) + a3*sin(e2 + e3) + x5*(cos(e2 + e3)*sin(e5) + sin(e2 + e3)*cos(e4)*cos(e5)) + y5*(cos(e2 + e3)*cos(e5) - sin(e2 + e3)*cos(e4)*sin(e5)) + z5*sin(e2 + e3)*sin(e4));
% M35 = I5zz*cos(e4) + cos(e6)*(I6yy*(cos(e4)*cos(e6) - cos(e5)*sin(e4)*sin(e6)) - I6xy*(cos(e4)*sin(e6) + cos(e5)*cos(e6)*sin(e4)) + I6yz*sin(e4)*sin(e5)) + sin(e6)*(I6xx*(cos(e4)*sin(e6) + cos(e5)*cos(e6)*sin(e4)) - I6xy*(cos(e4)*cos(e6) - cos(e5)*sin(e4)*sin(e6)) + I6zx*sin(e4)*sin(e5)) - m6*(z6*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5)) + x6*cos(e6)*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)) - y6*sin(e6)*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)))*(x6*(cos(e6)*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) + cos(e2 + e3)*sin(e1)*sin(e4)*sin(e6)) - y6*(sin(e6)*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) - cos(e2 + e3)*cos(e6)*sin(e1)*sin(e4)) + z6*(sin(e2 + e3)*cos(e5)*sin(e1) + cos(e2 + e3)*cos(e4)*sin(e1)*sin(e5)) - sin(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3))) + m6*(z6*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5)) + x6*cos(e6)*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5)) - y6*sin(e6)*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5)))*(x6*(cos(e6)*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) + cos(e2 + e3)*cos(e1)*sin(e4)*sin(e6)) - y6*(sin(e6)*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) - cos(e2 + e3)*cos(e1)*cos(e6)*sin(e4)) + z6*(sin(e2 + e3)*cos(e1)*cos(e5) + cos(e2 + e3)*cos(e1)*cos(e4)*sin(e5)) - cos(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3))) + I5zx*cos(e5)*sin(e4) - m5*(x5*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)) + y5*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5)))*(x5*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) + y5*(sin(e2 + e3)*cos(e5)*sin(e1) + cos(e2 + e3)*cos(e4)*sin(e1)*sin(e5)) - sin(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3)) - z5*cos(e2 + e3)*sin(e1)*sin(e4)) - I5yz*sin(e4)*sin(e5) - m6*(z6*(sin(e2 + e3)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)) - x6*cos(e6)*(sin(e2 + e3)*cos(e5) + cos(e2 + e3)*cos(e4)*sin(e5)) + y6*sin(e6)*(sin(e2 + e3)*cos(e5) + cos(e2 + e3)*cos(e4)*sin(e5)))*(d4*cos(e2 + e3) + a3*sin(e2 + e3) + z6*(cos(e2 + e3)*cos(e5) - sin(e2 + e3)*cos(e4)*sin(e5)) + x6*(cos(e6)*(cos(e2 + e3)*sin(e5) + sin(e2 + e3)*cos(e4)*cos(e5)) - sin(e2 + e3)*sin(e4)*sin(e6)) - y6*(sin(e6)*(cos(e2 + e3)*sin(e5) + sin(e2 + e3)*cos(e4)*cos(e5)) + sin(e2 + e3)*cos(e6)*sin(e4))) + m5*(x5*(sin(e2 + e3)*cos(e5) + cos(e2 + e3)*cos(e4)*sin(e5)) - y5*(sin(e2 + e3)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)))*(d4*cos(e2 + e3) + a3*sin(e2 + e3) + x5*(cos(e2 + e3)*sin(e5) + sin(e2 + e3)*cos(e4)*cos(e5)) + y5*(cos(e2 + e3)*cos(e5) - sin(e2 + e3)*cos(e4)*sin(e5)) + z5*sin(e2 + e3)*sin(e4)) + m5*(x5*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5)) + y5*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5)))*(x5*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) + y5*(sin(e2 + e3)*cos(e1)*cos(e5) + cos(e2 + e3)*cos(e1)*cos(e4)*sin(e5)) - cos(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3)) - z5*cos(e2 + e3)*cos(e1)*sin(e4));
% M36 = I6yz*(cos(e4)*cos(e6) - cos(e5)*sin(e4)*sin(e6)) + I6zx*(cos(e4)*sin(e6) + cos(e5)*cos(e6)*sin(e4)) - m6*(x6*(cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - sin(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) - y6*(sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + cos(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))))*(x6*(cos(e6)*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) + cos(e2 + e3)*cos(e1)*sin(e4)*sin(e6)) - y6*(sin(e6)*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) - cos(e2 + e3)*cos(e1)*cos(e6)*sin(e4)) + z6*(sin(e2 + e3)*cos(e1)*cos(e5) + cos(e2 + e3)*cos(e1)*cos(e4)*sin(e5)) - cos(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3))) + I6zz*sin(e4)*sin(e5) - m6*(x6*(sin(e6)*(sin(e2 + e3)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)) - cos(e2 + e3)*cos(e6)*sin(e4)) + y6*(cos(e6)*(sin(e2 + e3)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)) + cos(e2 + e3)*sin(e4)*sin(e6)))*(d4*cos(e2 + e3) + a3*sin(e2 + e3) + z6*(cos(e2 + e3)*cos(e5) - sin(e2 + e3)*cos(e4)*sin(e5)) + x6*(cos(e6)*(cos(e2 + e3)*sin(e5) + sin(e2 + e3)*cos(e4)*cos(e5)) - sin(e2 + e3)*sin(e4)*sin(e6)) - y6*(sin(e6)*(cos(e2 + e3)*sin(e5) + sin(e2 + e3)*cos(e4)*cos(e5)) + sin(e2 + e3)*cos(e6)*sin(e4))) + m6*(x6*(cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - sin(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) - y6*(sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) + cos(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))))*(x6*(cos(e6)*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) + cos(e2 + e3)*sin(e1)*sin(e4)*sin(e6)) - y6*(sin(e6)*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) - cos(e2 + e3)*cos(e6)*sin(e1)*sin(e4)) + z6*(sin(e2 + e3)*cos(e5)*sin(e1) + cos(e2 + e3)*cos(e4)*sin(e1)*sin(e5)) - sin(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3)));
% 
% M41 = I4yz*(cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4)) - I4zz*sin(e2 + e3) - (I6xx*cos(e6)*sin(e5) - I6zx*cos(e5) + I6xy*sin(e5)*sin(e6))*(cos(e2)*cos(e3)*sin(e4)*sin(e6) + cos(e2)*cos(e6)*sin(e3)*sin(e5) + cos(e3)*cos(e6)*sin(e2)*sin(e5) - sin(e2)*sin(e3)*sin(e4)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*cos(e6) + cos(e4)*cos(e5)*cos(e6)*sin(e2)*sin(e3)) - I4zx*(cos(e2)*cos(e3)*cos(e4) - cos(e4)*sin(e2)*sin(e3)) - (I6yz*cos(e5) + I6xy*cos(e6)*sin(e5) + I6yy*sin(e5)*sin(e6))*(cos(e6)*sin(e2)*sin(e3)*sin(e4) - cos(e2)*cos(e3)*cos(e6)*sin(e4) + cos(e2)*sin(e3)*sin(e5)*sin(e6) + cos(e3)*sin(e2)*sin(e5)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*sin(e6) + cos(e4)*cos(e5)*sin(e2)*sin(e3)*sin(e6)) - (I6zz*cos(e5) - I6zx*cos(e6)*sin(e5) + I6yz*sin(e5)*sin(e6))*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5)) - (cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4))*(I5yz*cos(e5) + I5zx*sin(e5)) + (I5xy*cos(e5) - I5xx*sin(e5))*(cos(e2)*sin(e3)*sin(e5) + cos(e3)*sin(e2)*sin(e5) - cos(e2)*cos(e3)*cos(e4)*cos(e5) + cos(e4)*cos(e5)*sin(e2)*sin(e3)) - (I5yy*cos(e5) - I5xy*sin(e5))*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5)) - m4*(x4*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - y4*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)))*(cos(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) + x4*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + y4*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + z4*cos(e2 + e3)*cos(e1)) + m6*(x6*(sin(e6)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e5)*cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4))) + y6*(cos(e6)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e5)*sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4))) + z6*sin(e5)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)))*(cos(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) + x6*(sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + cos(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) + y6*(cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - sin(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) - z6*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5))) - m4*(x4*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - y4*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)))*(sin(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) - x4*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - y4*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) + z4*cos(e2 + e3)*sin(e1)) - m5*(z5*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + x5*cos(e5)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - y5*sin(e5)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)))*(cos(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) - z5*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + x5*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5)) - y5*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5))) + m6*(x6*(sin(e6)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e5)*cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4))) + y6*(cos(e6)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e5)*sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4))) + z6*sin(e5)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)))*(sin(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) - x6*(sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) + cos(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) - y6*(cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - sin(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) + z6*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1))) - m5*(z5*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + x5*cos(e5)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - y5*sin(e5)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)))*(sin(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) + z5*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - x5*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5)) + y5*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)));
% M42 = I4yz*cos(e4) - I5xy*sin(e4) + I4zx*sin(e4) - I5yz*cos(e4)*cos(e5) - I6xy*cos(e4)*sin(e5) - I5zx*cos(e4)*sin(e5) - I6zx*cos(e6)*sin(e4) + I6yz*sin(e4)*sin(e6) + 2*I5xy*cos(e5)^2*sin(e4) + I6yz*cos(e4)*cos(e5)*cos(e6) + I6zx*cos(e4)*cos(e5)*sin(e6) - I5xx*cos(e5)*sin(e4)*sin(e5) + I5yy*cos(e5)*sin(e4)*sin(e5) - I6yy*cos(e5)*sin(e4)*sin(e5) + I6zz*cos(e5)*sin(e4)*sin(e5) + 2*I6xy*cos(e4)*cos(e6)^2*sin(e5) + 2*I6zx*cos(e5)^2*cos(e6)*sin(e4) + d4*m4*y4*cos(e4) - d4*m5*z5*cos(e4) + d4*m4*x4*sin(e4) - 2*I6yz*cos(e5)^2*sin(e4)*sin(e6) + m4*y4*z4*cos(e4) - m5*x5*y5*sin(e4) + m4*x4*z4*sin(e4) + m5*x5^2*cos(e5)*sin(e4)*sin(e5) - m5*y5^2*cos(e5)*sin(e4)*sin(e5) + m6*y6^2*cos(e5)*sin(e4)*sin(e5) - m6*z6^2*cos(e5)*sin(e4)*sin(e5) + d4*m6*y6*cos(e4)*cos(e6) - a2*m4*y4*cos(e4)*sin(e3) + a2*m5*z5*cos(e4)*sin(e3) + d4*m5*x5*cos(e5)*sin(e4) + d4*m6*x6*cos(e4)*sin(e6) - I6xx*cos(e5)*cos(e6)^2*sin(e4)*sin(e5) + I6yy*cos(e5)*cos(e6)^2*sin(e4)*sin(e5) - m5*y5*z5*cos(e4)*cos(e5) - a2*m4*x4*sin(e3)*sin(e4) - d4*m5*y5*sin(e4)*sin(e5) - d4*m6*z6*sin(e4)*sin(e5) - m6*x6*y6*cos(e4)*sin(e5) - m5*x5*z5*cos(e4)*sin(e5) - m6*x6*z6*cos(e6)*sin(e4) + m6*y6*z6*sin(e4)*sin(e6) + 2*m5*x5*y5*cos(e5)^2*sin(e4) - I6xx*cos(e4)*cos(e6)*sin(e5)*sin(e6) + I6yy*cos(e4)*cos(e6)*sin(e5)*sin(e6) - a2*m6*y6*cos(e4)*cos(e6)*sin(e3) + d4*m6*x6*cos(e5)*cos(e6)*sin(e4) + m6*y6*z6*cos(e4)*cos(e5)*cos(e6) - a2*m5*x5*cos(e5)*sin(e3)*sin(e4) - a2*m6*x6*cos(e4)*sin(e3)*sin(e6) - d4*m6*y6*cos(e5)*sin(e4)*sin(e6) + m6*x6*z6*cos(e4)*cos(e5)*sin(e6) + a2*m5*y5*sin(e3)*sin(e4)*sin(e5) + a2*m6*z6*sin(e3)*sin(e4)*sin(e5) + m6*x6^2*cos(e5)*cos(e6)^2*sin(e4)*sin(e5) - m6*y6^2*cos(e5)*cos(e6)^2*sin(e4)*sin(e5) + 2*m6*x6*y6*cos(e4)*cos(e6)^2*sin(e5) + 2*m6*x6*z6*cos(e5)^2*cos(e6)*sin(e4) - 2*m6*y6*z6*cos(e5)^2*sin(e4)*sin(e6) - 2*I6xy*cos(e5)*cos(e6)*sin(e4)*sin(e5)*sin(e6) + m6*x6^2*cos(e4)*cos(e6)*sin(e5)*sin(e6) - m6*y6^2*cos(e4)*cos(e6)*sin(e5)*sin(e6) - a2*m6*x6*cos(e5)*cos(e6)*sin(e3)*sin(e4) + a2*m6*y6*cos(e5)*sin(e3)*sin(e4)*sin(e6) - 2*m6*x6*y6*cos(e5)*cos(e6)*sin(e4)*sin(e5)*sin(e6);
% M43 = I4yz*cos(e4) - cos(e4)*(I5yz*cos(e5) + I5zx*sin(e5)) + I4zx*sin(e4) - (cos(e4)*sin(e6) + cos(e5)*cos(e6)*sin(e4))*(I6xx*cos(e6)*sin(e5) - I6zx*cos(e5) + I6xy*sin(e5)*sin(e6)) + (cos(e4)*cos(e6) - cos(e5)*sin(e4)*sin(e6))*(I6yz*cos(e5) + I6xy*cos(e6)*sin(e5) + I6yy*sin(e5)*sin(e6)) - m5*(z5*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + x5*cos(e5)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - y5*sin(e5)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)))*(x5*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) + y5*(sin(e2 + e3)*cos(e1)*cos(e5) + cos(e2 + e3)*cos(e1)*cos(e4)*sin(e5)) - cos(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3)) - z5*cos(e2 + e3)*cos(e1)*sin(e4)) + m6*(x6*(sin(e6)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e5)*cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4))) + y6*(cos(e6)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e5)*sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4))) + z6*sin(e5)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)))*(x6*(cos(e6)*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) + cos(e2 + e3)*cos(e1)*sin(e4)*sin(e6)) - y6*(sin(e6)*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) - cos(e2 + e3)*cos(e1)*cos(e6)*sin(e4)) + z6*(sin(e2 + e3)*cos(e1)*cos(e5) + cos(e2 + e3)*cos(e1)*cos(e4)*sin(e5)) - cos(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3))) + cos(e5)*sin(e4)*(I5xy*cos(e5) - I5xx*sin(e5)) + sin(e4)*sin(e5)*(I5yy*cos(e5) - I5xy*sin(e5)) + m5*(z5*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + x5*cos(e5)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - y5*sin(e5)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)))*(x5*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) + y5*(sin(e2 + e3)*cos(e5)*sin(e1) + cos(e2 + e3)*cos(e4)*sin(e1)*sin(e5)) - sin(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3)) - z5*cos(e2 + e3)*sin(e1)*sin(e4)) + sin(e4)*sin(e5)*(I6zz*cos(e5) - I6zx*cos(e6)*sin(e5) + I6yz*sin(e5)*sin(e6)) + m6*(x6*(cos(e2 + e3)*cos(e4)*sin(e6) + cos(e2 + e3)*cos(e5)*cos(e6)*sin(e4)) + y6*(cos(e2 + e3)*cos(e4)*cos(e6) - cos(e2 + e3)*cos(e5)*sin(e4)*sin(e6)) - z6*cos(e2 + e3)*sin(e4)*sin(e5))*(d4*cos(e2 + e3) + a3*sin(e2 + e3) + z6*(cos(e2 + e3)*cos(e5) - sin(e2 + e3)*cos(e4)*sin(e5)) + x6*(cos(e6)*(cos(e2 + e3)*sin(e5) + sin(e2 + e3)*cos(e4)*cos(e5)) - sin(e2 + e3)*sin(e4)*sin(e6)) - y6*(sin(e6)*(cos(e2 + e3)*sin(e5) + sin(e2 + e3)*cos(e4)*cos(e5)) + sin(e2 + e3)*cos(e6)*sin(e4))) + m4*(y4*cos(e2 + e3)*cos(e4) + x4*cos(e2 + e3)*sin(e4))*(d4*cos(e2 + e3) + a3*sin(e2 + e3) + z4*cos(e2 + e3) + x4*sin(e2 + e3)*cos(e4) - y4*sin(e2 + e3)*sin(e4)) + m4*(x4*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - y4*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)))*(cos(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3)) - z4*sin(e2 + e3)*cos(e1) - y4*cos(e2 + e3)*cos(e1)*sin(e4) + x4*cos(e2 + e3)*cos(e1)*cos(e4)) - m6*(x6*(sin(e6)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e5)*cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4))) + y6*(cos(e6)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e5)*sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4))) + z6*sin(e5)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)))*(x6*(cos(e6)*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) + cos(e2 + e3)*sin(e1)*sin(e4)*sin(e6)) - y6*(sin(e6)*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) - cos(e2 + e3)*cos(e6)*sin(e1)*sin(e4)) + z6*(sin(e2 + e3)*cos(e5)*sin(e1) + cos(e2 + e3)*cos(e4)*sin(e1)*sin(e5)) - sin(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3))) - m4*(x4*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - y4*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)))*(sin(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3)) - z4*sin(e2 + e3)*sin(e1) + x4*cos(e2 + e3)*cos(e4)*sin(e1) - y4*cos(e2 + e3)*sin(e1)*sin(e4)) - m5*(z5*cos(e2 + e3)*cos(e4) - x5*cos(e2 + e3)*cos(e5)*sin(e4) + y5*cos(e2 + e3)*sin(e4)*sin(e5))*(d4*cos(e2 + e3) + a3*sin(e2 + e3) + x5*(cos(e2 + e3)*sin(e5) + sin(e2 + e3)*cos(e4)*cos(e5)) + y5*(cos(e2 + e3)*cos(e5) - sin(e2 + e3)*cos(e4)*sin(e5)) + z5*sin(e2 + e3)*sin(e4));
% M44 = I5xx + I6yy + I4zz + m4*x4^2 + m6*x6^2 + m4*y4^2 + m5*y5^2 + m5*z5^2 + m6*z6^2 - I5xx*cos(e5)^2 + I6xx*cos(e6)^2 + I5yy*cos(e5)^2 - I6yy*cos(e5)^2 - I6yy*cos(e6)^2 + I6zz*cos(e5)^2 - I5xy*sin(2*e5) + I6xy*sin(2*e6) + m5*x5^2*cos(e5)^2 - m6*x6^2*cos(e6)^2 - m5*y5^2*cos(e5)^2 + m6*y6^2*cos(e5)^2 + m6*y6^2*cos(e6)^2 - m6*z6^2*cos(e5)^2 - I6xx*cos(e5)^2*cos(e6)^2 + I6yy*cos(e5)^2*cos(e6)^2 - 2*I6zx*cos(e5)*cos(e6)*sin(e5) + 2*I6yz*cos(e5)*sin(e5)*sin(e6) - 2*I6xy*cos(e5)^2*cos(e6)*sin(e6) + m6*x6^2*cos(e5)^2*cos(e6)^2 - m6*y6^2*cos(e5)^2*cos(e6)^2 - m5*x5*y5*sin(2*e5) + m6*x6*y6*sin(2*e6) - 2*m6*x6*z6*cos(e5)*cos(e6)*sin(e5) + 2*m6*y6*z6*cos(e5)*sin(e5)*sin(e6) - 2*m6*x6*y6*cos(e5)^2*cos(e6)*sin(e6);
% M45 = cos(e6)*(I6yz*cos(e5) + I6xy*cos(e6)*sin(e5) + I6yy*sin(e5)*sin(e6)) - I5zx*sin(e5) - I5yz*cos(e5) - sin(e6)*(I6xx*cos(e6)*sin(e5) - I6zx*cos(e5) + I6xy*sin(e5)*sin(e6)) - m6*(z6*(sin(e2 + e3)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)) - x6*cos(e6)*(sin(e2 + e3)*cos(e5) + cos(e2 + e3)*cos(e4)*sin(e5)) + y6*sin(e6)*(sin(e2 + e3)*cos(e5) + cos(e2 + e3)*cos(e4)*sin(e5)))*(x6*(cos(e2 + e3)*cos(e4)*sin(e6) + cos(e2 + e3)*cos(e5)*cos(e6)*sin(e4)) + y6*(cos(e2 + e3)*cos(e4)*cos(e6) - cos(e2 + e3)*cos(e5)*sin(e4)*sin(e6)) - z6*cos(e2 + e3)*sin(e4)*sin(e5)) + m6*(z6*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5)) + x6*cos(e6)*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5)) - y6*sin(e6)*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5)))*(x6*(sin(e6)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e5)*cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4))) + y6*(cos(e6)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e5)*sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4))) + z6*sin(e5)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4))) + m6*(x6*(sin(e6)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e5)*cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4))) + y6*(cos(e6)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e5)*sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4))) + z6*sin(e5)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)))*(z6*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5)) + x6*cos(e6)*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)) - y6*sin(e6)*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1))) - m5*(x5*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5)) + y5*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5)))*(z5*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + x5*cos(e5)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - y5*sin(e5)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4))) - m5*(x5*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)) + y5*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5)))*(z5*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + x5*cos(e5)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - y5*sin(e5)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4))) - m5*(x5*(sin(e2 + e3)*cos(e5) + cos(e2 + e3)*cos(e4)*sin(e5)) - y5*(sin(e2 + e3)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)))*(z5*cos(e2 + e3)*cos(e4) - x5*cos(e2 + e3)*cos(e5)*sin(e4) + y5*cos(e2 + e3)*sin(e4)*sin(e5)); 
% M46 = I6zz*cos(e5) - m6*(x6*(sin(e6)*(sin(e2 + e3)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)) - cos(e2 + e3)*cos(e6)*sin(e4)) + y6*(cos(e6)*(sin(e2 + e3)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)) + cos(e2 + e3)*sin(e4)*sin(e6)))*(x6*(cos(e2 + e3)*cos(e4)*sin(e6) + cos(e2 + e3)*cos(e5)*cos(e6)*sin(e4)) + y6*(cos(e2 + e3)*cos(e4)*cos(e6) - cos(e2 + e3)*cos(e5)*sin(e4)*sin(e6)) - z6*cos(e2 + e3)*sin(e4)*sin(e5)) - m6*(x6*(cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - sin(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) - y6*(sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + cos(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))))*(x6*(sin(e6)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e5)*cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4))) + y6*(cos(e6)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e5)*sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4))) + z6*sin(e5)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4))) - I6zx*cos(e6)*sin(e5) - m6*(x6*(cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - sin(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) - y6*(sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) + cos(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))))*(x6*(sin(e6)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e5)*cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4))) + y6*(cos(e6)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e5)*sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4))) + z6*sin(e5)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4))) + I6yz*sin(e5)*sin(e6);
% 
% M51 = I5zz*(cos(e2)*cos(e3)*sin(e4) - sin(e2)*sin(e3)*sin(e4)) - (I6yy*cos(e6) - I6xy*sin(e6))*(cos(e6)*sin(e2)*sin(e3)*sin(e4) - cos(e2)*cos(e3)*cos(e6)*sin(e4) + cos(e2)*sin(e3)*sin(e5)*sin(e6) + cos(e3)*sin(e2)*sin(e5)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*sin(e6) + cos(e4)*cos(e5)*sin(e2)*sin(e3)*sin(e6)) - (I6xy*cos(e6) - I6xx*sin(e6))*(cos(e2)*cos(e3)*sin(e4)*sin(e6) + cos(e2)*cos(e6)*sin(e3)*sin(e5) + cos(e3)*cos(e6)*sin(e2)*sin(e5) - sin(e2)*sin(e3)*sin(e4)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*cos(e6) + cos(e4)*cos(e5)*cos(e6)*sin(e2)*sin(e3)) + I5yz*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5)) + I5zx*(cos(e2)*sin(e3)*sin(e5) + cos(e3)*sin(e2)*sin(e5) - cos(e2)*cos(e3)*cos(e4)*cos(e5) + cos(e4)*cos(e5)*sin(e2)*sin(e3)) - (I6yz*cos(e6) + I6zx*sin(e6))*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5)) + m5*(x5*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)) + y5*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5)))*(cos(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) - z5*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + x5*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5)) - y5*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5))) + m5*(x5*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5)) + y5*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5)))*(sin(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) + z5*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - x5*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5)) + y5*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1))) + m6*(z6*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5)) + x6*cos(e6)*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)) - y6*sin(e6)*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)))*(cos(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) + x6*(sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + cos(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) + y6*(cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - sin(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) - z6*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5))) + m6*(z6*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5)) + x6*cos(e6)*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5)) - y6*sin(e6)*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5)))*(sin(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) - x6*(sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) + cos(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) - y6*(cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - sin(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) + z6*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)));
% M52 = I6xx*cos(e4) + I5zz*cos(e4) + I6xy*cos(e5)*sin(e4) + I5zx*cos(e5)*sin(e4) - I5yz*sin(e4)*sin(e5) + m5*x5^2*cos(e4) + m5*y5^2*cos(e4) + m6*y6^2*cos(e4) + m6*z6^2*cos(e4) - I6xx*cos(e4)*cos(e6)^2 + I6yy*cos(e4)*cos(e6)^2 - 2*I6xy*cos(e4)*cos(e6)*sin(e6) + I6yz*cos(e6)*sin(e4)*sin(e5) + I6zx*sin(e4)*sin(e5)*sin(e6) + a3*m5*x5*cos(e5) - 2*I6xy*cos(e5)*cos(e6)^2*sin(e4) - a3*m5*y5*sin(e5) - a3*m6*z6*sin(e5) + m6*x6^2*cos(e4)*cos(e6)^2 - m6*y6^2*cos(e4)*cos(e6)^2 + a2*m5*x5*cos(e3)*cos(e5) + a3*m6*x6*cos(e5)*cos(e6) + d4*m5*y5*cos(e4)*cos(e5) + d4*m6*z6*cos(e4)*cos(e5) - a2*m5*y5*cos(e3)*sin(e5) - a3*m6*y6*cos(e5)*sin(e6) - a2*m6*z6*cos(e3)*sin(e5) + d4*m5*x5*cos(e4)*sin(e5) + m6*x6*y6*cos(e5)*sin(e4) + m5*x5*z5*cos(e5)*sin(e4) - m5*y5*z5*sin(e4)*sin(e5) + I6xx*cos(e5)*cos(e6)*sin(e4)*sin(e6) - I6yy*cos(e5)*cos(e6)*sin(e4)*sin(e6) - a2*m5*y5*cos(e4)*cos(e5)*sin(e3) - a2*m6*y6*cos(e3)*cos(e5)*sin(e6) - a2*m6*z6*cos(e4)*cos(e5)*sin(e3) + d4*m6*x6*cos(e4)*cos(e6)*sin(e5) - a2*m5*x5*cos(e4)*sin(e3)*sin(e5) - d4*m6*y6*cos(e4)*sin(e5)*sin(e6) - 2*m6*x6*y6*cos(e4)*cos(e6)*sin(e6) + m6*y6*z6*cos(e6)*sin(e4)*sin(e5) + m6*x6*z6*sin(e4)*sin(e5)*sin(e6) - 2*m6*x6*y6*cos(e5)*cos(e6)^2*sin(e4) - m6*x6^2*cos(e5)*cos(e6)*sin(e4)*sin(e6) + m6*y6^2*cos(e5)*cos(e6)*sin(e4)*sin(e6) + a2*m6*x6*cos(e3)*cos(e5)*cos(e6) - a2*m6*x6*cos(e4)*cos(e6)*sin(e3)*sin(e5) + a2*m6*y6*cos(e4)*sin(e3)*sin(e5)*sin(e6);
% M53 = I5zz*cos(e4) - (cos(e4)*sin(e6) + cos(e5)*cos(e6)*sin(e4))*(I6xy*cos(e6) - I6xx*sin(e6)) + (cos(e4)*cos(e6) - cos(e5)*sin(e4)*sin(e6))*(I6yy*cos(e6) - I6xy*sin(e6)) - m6*(z6*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5)) + x6*cos(e6)*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)) - y6*sin(e6)*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)))*(x6*(cos(e6)*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) + cos(e2 + e3)*sin(e1)*sin(e4)*sin(e6)) - y6*(sin(e6)*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) - cos(e2 + e3)*cos(e6)*sin(e1)*sin(e4)) + z6*(sin(e2 + e3)*cos(e5)*sin(e1) + cos(e2 + e3)*cos(e4)*sin(e1)*sin(e5)) - sin(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3))) + m6*(z6*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5)) + x6*cos(e6)*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5)) - y6*sin(e6)*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5)))*(x6*(cos(e6)*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) + cos(e2 + e3)*cos(e1)*sin(e4)*sin(e6)) - y6*(sin(e6)*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) - cos(e2 + e3)*cos(e1)*cos(e6)*sin(e4)) + z6*(sin(e2 + e3)*cos(e1)*cos(e5) + cos(e2 + e3)*cos(e1)*cos(e4)*sin(e5)) - cos(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3))) + I5zx*cos(e5)*sin(e4) - m5*(x5*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)) + y5*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5)))*(x5*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) + y5*(sin(e2 + e3)*cos(e5)*sin(e1) + cos(e2 + e3)*cos(e4)*sin(e1)*sin(e5)) - sin(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3)) - z5*cos(e2 + e3)*sin(e1)*sin(e4)) - I5yz*sin(e4)*sin(e5) + sin(e4)*sin(e5)*(I6yz*cos(e6) + I6zx*sin(e6)) - m6*(z6*(sin(e2 + e3)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)) - x6*cos(e6)*(sin(e2 + e3)*cos(e5) + cos(e2 + e3)*cos(e4)*sin(e5)) + y6*sin(e6)*(sin(e2 + e3)*cos(e5) + cos(e2 + e3)*cos(e4)*sin(e5)))*(d4*cos(e2 + e3) + a3*sin(e2 + e3) + z6*(cos(e2 + e3)*cos(e5) - sin(e2 + e3)*cos(e4)*sin(e5)) + x6*(cos(e6)*(cos(e2 + e3)*sin(e5) + sin(e2 + e3)*cos(e4)*cos(e5)) - sin(e2 + e3)*sin(e4)*sin(e6)) - y6*(sin(e6)*(cos(e2 + e3)*sin(e5) + sin(e2 + e3)*cos(e4)*cos(e5)) + sin(e2 + e3)*cos(e6)*sin(e4))) + m5*(x5*(sin(e2 + e3)*cos(e5) + cos(e2 + e3)*cos(e4)*sin(e5)) - y5*(sin(e2 + e3)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)))*(d4*cos(e2 + e3) + a3*sin(e2 + e3) + x5*(cos(e2 + e3)*sin(e5) + sin(e2 + e3)*cos(e4)*cos(e5)) + y5*(cos(e2 + e3)*cos(e5) - sin(e2 + e3)*cos(e4)*sin(e5)) + z5*sin(e2 + e3)*sin(e4)) + m5*(x5*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5)) + y5*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5)))*(x5*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) + y5*(sin(e2 + e3)*cos(e1)*cos(e5) + cos(e2 + e3)*cos(e1)*cos(e4)*sin(e5)) - cos(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3)) - z5*cos(e2 + e3)*cos(e1)*sin(e4));
% M54 = cos(e5)*(I6yz*cos(e6) + I6zx*sin(e6)) - I5yz*cos(e5) - I5zx*sin(e5) - m6*(z6*(sin(e2 + e3)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)) - x6*cos(e6)*(sin(e2 + e3)*cos(e5) + cos(e2 + e3)*cos(e4)*sin(e5)) + y6*sin(e6)*(sin(e2 + e3)*cos(e5) + cos(e2 + e3)*cos(e4)*sin(e5)))*(x6*(cos(e2 + e3)*cos(e4)*sin(e6) + cos(e2 + e3)*cos(e5)*cos(e6)*sin(e4)) + y6*(cos(e2 + e3)*cos(e4)*cos(e6) - cos(e2 + e3)*cos(e5)*sin(e4)*sin(e6)) - z6*cos(e2 + e3)*sin(e4)*sin(e5)) + m6*(z6*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5)) + x6*cos(e6)*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5)) - y6*sin(e6)*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5)))*(x6*(sin(e6)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e5)*cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4))) + y6*(cos(e6)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e5)*sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4))) + z6*sin(e5)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4))) + cos(e6)*sin(e5)*(I6xy*cos(e6) - I6xx*sin(e6)) + sin(e5)*sin(e6)*(I6yy*cos(e6) - I6xy*sin(e6)) + m6*(x6*(sin(e6)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e5)*cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4))) + y6*(cos(e6)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e5)*sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4))) + z6*sin(e5)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)))*(z6*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5)) + x6*cos(e6)*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)) - y6*sin(e6)*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1))) - m5*(x5*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5)) + y5*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5)))*(z5*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + x5*cos(e5)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - y5*sin(e5)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4))) - m5*(x5*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)) + y5*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5)))*(z5*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + x5*cos(e5)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - y5*sin(e5)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4))) - m5*(x5*(sin(e2 + e3)*cos(e5) + cos(e2 + e3)*cos(e4)*sin(e5)) - y5*(sin(e2 + e3)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)))*(z5*cos(e2 + e3)*cos(e4) - x5*cos(e2 + e3)*cos(e5)*sin(e4) + y5*cos(e2 + e3)*sin(e4)*sin(e5));
% M55 = I6xx + I5zz + m5*x5^2 + m5*y5^2 + m6*y6^2 + m6*z6^2 - I6xx*cos(e6)^2 + I6yy*cos(e6)^2 - I6xy*sin(2*e6) + m6*x6^2*cos(e6)^2 - m6*y6^2*cos(e6)^2 - m6*x6*y6*sin(2*e6);
% M56 = I6yz*cos(e6) + I6zx*sin(e6) + m6*(x6*(sin(e6)*(sin(e2 + e3)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)) - cos(e2 + e3)*cos(e6)*sin(e4)) + y6*(cos(e6)*(sin(e2 + e3)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)) + cos(e2 + e3)*sin(e4)*sin(e6)))*(z6*(sin(e2 + e3)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)) - x6*cos(e6)*(sin(e2 + e3)*cos(e5) + cos(e2 + e3)*cos(e4)*sin(e5)) + y6*sin(e6)*(sin(e2 + e3)*cos(e5) + cos(e2 + e3)*cos(e4)*sin(e5))) - m6*(x6*(cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - sin(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) - y6*(sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + cos(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))))*(z6*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5)) + x6*cos(e6)*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5)) - y6*sin(e6)*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5))) - m6*(x6*(cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - sin(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) - y6*(sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) + cos(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))))*(z6*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5)) + x6*cos(e6)*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)) - y6*sin(e6)*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)));
% 
% M61 = I6zx*(cos(e2)*cos(e3)*sin(e4)*sin(e6) + cos(e2)*cos(e6)*sin(e3)*sin(e5) + cos(e3)*cos(e6)*sin(e2)*sin(e5) - sin(e2)*sin(e3)*sin(e4)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*cos(e6) + cos(e4)*cos(e5)*cos(e6)*sin(e2)*sin(e3)) - I6yz*(cos(e6)*sin(e2)*sin(e3)*sin(e4) - cos(e2)*cos(e3)*cos(e6)*sin(e4) + cos(e2)*sin(e3)*sin(e5)*sin(e6) + cos(e3)*sin(e2)*sin(e5)*sin(e6) - cos(e2)*cos(e3)*cos(e4)*cos(e5)*sin(e6) + cos(e4)*cos(e5)*sin(e2)*sin(e3)*sin(e6)) - I6zz*(cos(e2)*cos(e5)*sin(e3) + cos(e3)*cos(e5)*sin(e2) + cos(e2)*cos(e3)*cos(e4)*sin(e5) - cos(e4)*sin(e2)*sin(e3)*sin(e5)) - m6*(x6*(cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - sin(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) - y6*(sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) + cos(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))))*(cos(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) + x6*(sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + cos(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) + y6*(cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - sin(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) - z6*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5))) - m6*(x6*(cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - sin(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) - y6*(sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + cos(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))))*(sin(e1)*(a1 + d4*cos(e2 + e3) + a3*sin(e2 + e3) + a2*sin(e2)) - x6*(sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) + cos(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) - y6*(cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - sin(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) + z6*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)));
% M62 = I6yz*cos(e4)*cos(e6) + I6zx*cos(e4)*sin(e6) + I6zz*sin(e4)*sin(e5) + I6zx*cos(e5)*cos(e6)*sin(e4) - I6yz*cos(e5)*sin(e4)*sin(e6) + m6*x6^2*sin(e4)*sin(e5) + m6*y6^2*sin(e4)*sin(e5) - a3*m6*y6*cos(e6)*sin(e5) + d4*m6*x6*cos(e6)*sin(e4) + m6*y6*z6*cos(e4)*cos(e6) - a3*m6*x6*sin(e5)*sin(e6) - d4*m6*y6*sin(e4)*sin(e6) + m6*x6*z6*cos(e4)*sin(e6) + d4*m6*y6*cos(e4)*cos(e5)*cos(e6) - a2*m6*y6*cos(e3)*cos(e6)*sin(e5) + d4*m6*x6*cos(e4)*cos(e5)*sin(e6) - a2*m6*x6*cos(e6)*sin(e3)*sin(e4) - a2*m6*x6*cos(e3)*sin(e5)*sin(e6) + m6*x6*z6*cos(e5)*cos(e6)*sin(e4) + a2*m6*y6*sin(e3)*sin(e4)*sin(e6) - m6*y6*z6*cos(e5)*sin(e4)*sin(e6) - a2*m6*y6*cos(e4)*cos(e5)*cos(e6)*sin(e3) - a2*m6*x6*cos(e4)*cos(e5)*sin(e3)*sin(e6);
% M63 = I6yz*(cos(e4)*cos(e6) - cos(e5)*sin(e4)*sin(e6)) + I6zx*(cos(e4)*sin(e6) + cos(e5)*cos(e6)*sin(e4)) - m6*(x6*(cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - sin(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) - y6*(sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + cos(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))))*(x6*(cos(e6)*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) + cos(e2 + e3)*cos(e1)*sin(e4)*sin(e6)) - y6*(sin(e6)*(sin(e2 + e3)*cos(e1)*sin(e5) - cos(e2 + e3)*cos(e1)*cos(e4)*cos(e5)) - cos(e2 + e3)*cos(e1)*cos(e6)*sin(e4)) + z6*(sin(e2 + e3)*cos(e1)*cos(e5) + cos(e2 + e3)*cos(e1)*cos(e4)*sin(e5)) - cos(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3))) + I6zz*sin(e4)*sin(e5) - m6*(x6*(sin(e6)*(sin(e2 + e3)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)) - cos(e2 + e3)*cos(e6)*sin(e4)) + y6*(cos(e6)*(sin(e2 + e3)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)) + cos(e2 + e3)*sin(e4)*sin(e6)))*(d4*cos(e2 + e3) + a3*sin(e2 + e3) + z6*(cos(e2 + e3)*cos(e5) - sin(e2 + e3)*cos(e4)*sin(e5)) + x6*(cos(e6)*(cos(e2 + e3)*sin(e5) + sin(e2 + e3)*cos(e4)*cos(e5)) - sin(e2 + e3)*sin(e4)*sin(e6)) - y6*(sin(e6)*(cos(e2 + e3)*sin(e5) + sin(e2 + e3)*cos(e4)*cos(e5)) + sin(e2 + e3)*cos(e6)*sin(e4))) + m6*(x6*(cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - sin(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) - y6*(sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) + cos(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))))*(x6*(cos(e6)*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) + cos(e2 + e3)*sin(e1)*sin(e4)*sin(e6)) - y6*(sin(e6)*(sin(e2 + e3)*sin(e1)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)*sin(e1)) - cos(e2 + e3)*cos(e6)*sin(e1)*sin(e4)) + z6*(sin(e2 + e3)*cos(e5)*sin(e1) + cos(e2 + e3)*cos(e4)*sin(e1)*sin(e5)) - sin(e1)*(a3*cos(e2 + e3) - d4*sin(e2 + e3)));
% M64 = I6zz*cos(e5) - m6*(x6*(sin(e6)*(sin(e2 + e3)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)) - cos(e2 + e3)*cos(e6)*sin(e4)) + y6*(cos(e6)*(sin(e2 + e3)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)) + cos(e2 + e3)*sin(e4)*sin(e6)))*(x6*(cos(e2 + e3)*cos(e4)*sin(e6) + cos(e2 + e3)*cos(e5)*cos(e6)*sin(e4)) + y6*(cos(e2 + e3)*cos(e4)*cos(e6) - cos(e2 + e3)*cos(e5)*sin(e4)*sin(e6)) - z6*cos(e2 + e3)*sin(e4)*sin(e5)) - m6*(x6*(cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - sin(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) - y6*(sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + cos(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))))*(x6*(sin(e6)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e5)*cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4))) + y6*(cos(e6)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e5)*sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4))) + z6*sin(e5)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4))) - I6zx*cos(e6)*sin(e5) - m6*(x6*(cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - sin(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) - y6*(sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) + cos(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))))*(x6*(sin(e6)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e5)*cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4))) + y6*(cos(e6)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e5)*sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4))) + z6*sin(e5)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4))) + I6yz*sin(e5)*sin(e6);
% M65 = I6yz*cos(e6) + I6zx*sin(e6) + m6*(x6*(sin(e6)*(sin(e2 + e3)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)) - cos(e2 + e3)*cos(e6)*sin(e4)) + y6*(cos(e6)*(sin(e2 + e3)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)) + cos(e2 + e3)*sin(e4)*sin(e6)))*(z6*(sin(e2 + e3)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)) - x6*cos(e6)*(sin(e2 + e3)*cos(e5) + cos(e2 + e3)*cos(e4)*sin(e5)) + y6*sin(e6)*(sin(e2 + e3)*cos(e5) + cos(e2 + e3)*cos(e4)*sin(e5))) - m6*(x6*(cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - sin(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) - y6*(sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + cos(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))))*(z6*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5)) + x6*cos(e6)*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5)) - y6*sin(e6)*(sin(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) - cos(e2 + e3)*cos(e1)*cos(e5))) - m6*(x6*(cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - sin(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) - y6*(sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) + cos(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))))*(z6*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5)) + x6*cos(e6)*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)) - y6*sin(e6)*(sin(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) + cos(e2 + e3)*cos(e5)*sin(e1)));
% M66 = I6zz + m6*(x6*(cos(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) - sin(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))) - y6*(sin(e6)*(cos(e4)*sin(e1) - sin(e2 + e3)*cos(e1)*sin(e4)) + cos(e6)*(cos(e5)*(sin(e1)*sin(e4) + sin(e2 + e3)*cos(e1)*cos(e4)) + cos(e2 + e3)*cos(e1)*sin(e5))))^2 + m6*(x6*(sin(e6)*(sin(e2 + e3)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)) - cos(e2 + e3)*cos(e6)*sin(e4)) + y6*(cos(e6)*(sin(e2 + e3)*sin(e5) - cos(e2 + e3)*cos(e4)*cos(e5)) + cos(e2 + e3)*sin(e4)*sin(e6)))^2 + m6*(x6*(cos(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) - sin(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))) - y6*(sin(e6)*(cos(e1)*cos(e4) + sin(e2 + e3)*sin(e1)*sin(e4)) + cos(e6)*(cos(e5)*(cos(e1)*sin(e4) - sin(e2 + e3)*cos(e4)*sin(e1)) - cos(e2 + e3)*sin(e1)*sin(e5))))^2;
%  

M1 = [M11; M21; M31; M41; M51; M61];
M2 = [M12; M22; M32; M42; M52; M62];
M3 = [M13; M23; M33; M43; M53; M63];
M4 = [M14; M24; M34; M44; M54; M64];
M5 = [M15; M25; M35; M45; M55; M65];
M6 = [M16; M26; M36; M46; M56; M66];
%% Potential energy
P = simplify(- m1*[0 0 g]*P01c - m2*[0 0 g]*P02c - m3*[0 0 g]*P03c - m4*[0 0 g]*P04c - m5*[0 0 g]*P05c - m6*[0 0 g]*P06c);
G = simplify([diff(P,e1);...
              diff(P,e2);...
              diff(P,e3);...
              diff(P,e4);...
              diff(P,e5);...
              diff(P,e6)]);
%% Coriolis/centrifugal matrix 
% create Kronecker tensor product
K1 = kron(diag([1,1,1,1,1,1]),[de1;de2;de3;de4;de5;de6]);
K2 = kron([de1;de2;de3;de4;de5;de6],diag([1,1,1,1,1,1]));
dM1e1 = simplify(diff(M1,e1));
dM1e2 = simplify(diff(M1,e2));
dM1e3 = simplify(diff(M1,e3));
dM1e4 = simplify(diff(M1,e4));
dM1e5 = simplify(diff(M1,e5));
dM1e6 = simplify(diff(M1,e6));

dM2e1 = simplify(diff(M2,e1));
dM2e2 = simplify(diff(M2,e2));
dM2e3 = simplify(diff(M2,e3));
dM2e4 = simplify(diff(M2,e4));
dM2e5 = simplify(diff(M2,e5));
dM2e6 = simplify(diff(M2,e6));

dM3e1 = simplify(diff(M3,e1));
dM3e2 = simplify(diff(M3,e2));
dM3e3 = simplify(diff(M3,e3));
dM3e4 = simplify(diff(M3,e4));
dM3e5 = simplify(diff(M3,e5));
dM3e6 = simplify(diff(M3,e6));

dM4e1 = simplify(diff(M4,e1));
dM4e2 = simplify(diff(M4,e2));
dM4e3 = simplify(diff(M4,e3));
dM4e4 = simplify(diff(M4,e4));
dM4e5 = simplify(diff(M4,e5));
dM4e6 = simplify(diff(M4,e6));

dM5e1 = simplify(diff(M5,e1));
dM5e2 = simplify(diff(M5,e2));
dM5e3 = simplify(diff(M5,e3));
dM5e4 = simplify(diff(M5,e4));
dM5e5 = simplify(diff(M5,e5));
dM5e6 = simplify(diff(M5,e6));

dM6e1 = simplify(diff(M6,e1));
dM6e2 = simplify(diff(M6,e2));
dM6e3 = simplify(diff(M6,e3));
dM6e4 = simplify(diff(M6,e4));
dM6e5 = simplify(diff(M6,e5));
dM6e6 = simplify(diff(M6,e6));

dMde = [dM1e1 dM1e2 dM1e3 dM1e4 dM1e5 dM1e6 dM2e1 dM2e2 dM2e3 dM2e4 dM2e5 dM2e6 dM3e1 dM3e2 dM3e3 dM3e4 dM3e5 dM3e6 dM4e1 dM4e2 dM4e3 dM4e4 dM4e5 dM4e6 dM5e1 dM5e2 dM5e3 dM5e4 dM5e5 dM5e6 dM6e1 dM6e2 dM6e3 dM6e4 dM6e5 dM6e6];
% dMde = simplify([diff(M1,e1) diff(M1,e2) diff(M1,e3) diff(M1,e4) diff(M1,e5) diff(M1,e6) diff(M2,e1) diff(M2,e2) diff(M2,e3) diff(M2,e4) diff(M2,e5) diff(M2,e6) diff(M3,e1) diff(M3,e2) diff(M3,e3) diff(M3,e4) diff(M3,e5) diff(M3,e6) diff(M4,e1) diff(M4,e2) diff(M4,e3) diff(M4,e4) diff(M4,e5) diff(M4,e6) diff(M5,e1) diff(M5,e2) diff(M5,e3) diff(M5,e4) diff(M5,e5) diff(M5,e6) diff(M6,e1) diff(M6,e2) diff(M6,e3) diff(M6,e4) diff(M6,e5) diff(M6,e6)])
dM = simplify(dMde*K1);
% cach 1: chung minh duoc skew matrix
C = simplify(0.5*(dM + dMde*K2 - (dMde*K2).'));
% cach 2: khong chung minh duoc skew matrix
% C2 = simplify(dM - 0.5*(dMde*K2)');
% check
skew = simplify(dM - 2*C); % this is skew matrix
x = [1;1;1;100;1;1];
err = simplify(x.'*(skew)*x)

%%
filedM = fopen('dM.txt','w'); 
fprintf(filedM,'dM = ...\n[%s,%s,%s,%s,%s,%s;\n %s,%s,%s,%s,%s,%s;\n %s,%s,%s,%s,%s,%s;\n %s,%s,%s,%s,%s,%s;\n %s,%s,%s,%s,%s,%s;\n %s,%s,%s,%s,%s,%s];',dM(1,1),dM(1,2),dM(1,3),dM(1,4),dM(1,5),dM(1,6),dM(2,1),dM(2,2),dM(2,3),dM(2,4),dM(2,5),dM(2,6),dM(3,1),dM(3,2),dM(3,3),dM(3,4),dM(3,5),dM(3,6),dM(4,1),dM(4,2),dM(4,3),dM(4,4),dM(4,5),dM(4,6),dM(5,1),dM(5,2),dM(5,3),dM(5,4),dM(5,5),dM(5,6),dM(6,1),dM(6,2),dM(6,3),dM(6,4),dM(6,5),dM(6,6));

fileM = fopen('M.txt','w'); 
fprintf(fileM,'M = ...\n[%s,%s,%s,%s,%s,%s;\n %s,%s,%s,%s,%s,%s;\n %s,%s,%s,%s,%s,%s;\n %s,%s,%s,%s,%s,%s;\n %s,%s,%s,%s,%s,%s;\n %s,%s,%s,%s,%s,%s];',M11,M12,M13,M14,M15,M16,M21,M22,M23,M24,M25,M26,M31,M32,M33,M34,M35,M36,M41,M42,M43,M44,M45,M46,M51,M52,M53,M54,M55,M56,M61,M62,M63,M64,M65,M66);

fileC = fopen('C.txt','w');
fprintf(fileC,'C = ...\n[%s,%s,%s,%s,%s,%s;\n %s,%s,%s,%s,%s,%s;\n %s,%s,%s,%s,%s,%s;\n %s,%s,%s,%s,%s,%s;\n %s,%s,%s,%s,%s,%s;\n %s,%s,%s,%s,%s,%s];',C(1,1),C(1,2),C(1,3),C(1,4),C(1,5),C(1,6),C(2,1),C(2,2),C(2,3),C(2,4),C(2,5),C(2,6),C(3,1),C(3,2),C(3,3),C(3,4),C(3,5),C(3,6),C(4,1),C(4,2),C(4,3),C(4,4),C(4,5),C(4,6),C(5,1),C(5,2),C(5,3),C(5,4),C(5,5),C(5,6),C(6,1),C(6,2),C(6,3),C(6,4),C(6,5),C(6,6));

fileG = fopen('G.txt','w');
fprintf(fileG,'G=...\n[%s;\n%s;\n%s;\n%s;\n%s;\n%s];',G(1),G(2),G(3),G(4),G(5),G(6));
